---
description: フラット ファイル データ ソースに接続する (SQL Server インポートおよびエクスポート ウィザード)
title: フラット ファイル データ ソースに接続する (SQL Server インポートおよびエクスポート ウィザード) | Microsoft Docs
ms.custom: ''
ms.date: 02/17/2017
ms.prod: sql
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
ms.assetid: d7e7067b-f5a5-482f-b97e-9d82fe8e9f76
author: chugugrace
ms.author: chugu
ms.openlocfilehash: cbbd57a1f195b3e2363357e653ff77129bb9f224
ms.sourcegitcommit: cfa04a73b26312bf18d8f6296891679166e2754d
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/19/2020
ms.locfileid: "92195192"
---
# <a name="connect-to-a-flat-file-data-source-sql-server-import-and-export-wizard"></a>フラット ファイル データ ソースに接続する (SQL Server インポートおよびエクスポート ウィザード)

[!INCLUDE[sqlserver-ssis](../../includes/applies-to-version/sqlserver-ssis.md)]


このトピックでは、SQL Server インポートおよびエクスポート ウィザードの **[データ ソースの選択]** ページまたは **[変換先の選択]** ページから **フラット ファイル (テキスト ファイル)** データ ソースに接続する方法を説明します。 フラット ファイルの場合、ウィザードのこの 2 つのページでは、それぞれ異なるオプション セットが提供されています。そのため、このトピックでは、フラット ファイル ソースとフラット ファイル変換先を別々に説明します。

## <a name="an-alternative-for-simple-text-import"></a>テキストのインポートを簡単にするための別の方法
テキスト ファイルを SQL Server にインポートする必要はあるが、インポート ウィザードやエクスポート ウィザードで使用可能な構成オプションが必ずしもすべて必要ではない場合は、SQL Server Management Studio (SSMS) の**フラット ファイルのインポート ウィザード**の使用をお勧めします。 詳細については、次の記事を参照してください。
- [SQL Server Management Studio 17.3 の新機能](https://blogs.technet.microsoft.com/dataplatforminsider/2017/10/10/whats-new-in-sql-server-management-studio-17-3/)
- [SSMS 17.3 の新しいフラット ファイルのインポート ウィザードの概要](https://channel9.msdn.com/Shows/Data-Exposed/Introducing-the-new-Import-Flat-File-Wizard-in-SSMS-173)

## <a name="connect-to-a-flat-file-source"></a>フラット ファイル ソースへの接続
 
 フラット ファイル データ ソース用のオプションに関するページは 4 ページあります。 このようにページ数が多くなっています。 しかし、各ページで多くの時間を費やす必要はありません。 検討すべきタスクを次に示します。
 
Page|推奨  |Type  
----|---------|---------
**全般**|必ず **[形式]** セクションのオプションを更新する。|推奨    
**[列]**|列と行の区切り記号の確認 (区切りファイルの場合)、または列のマーク付け (固定幅ファイルの場合) を必ず行う。|推奨
**詳細**|必要に応じて、既定で列に割り当てられているデータ型とその他のプロパティを確認する。|省略可能
**プレビュー**|必要に応じて、指定した設定を使用して、データのサンプルをプレビューする。|省略可能

## <a name="general-page-source"></a>[全般] ページ (ソース)
 **[全般]** ページでは、ファイルを選択し、**[フォーマット]** セクションで設定を確認できます。
 
 ![フラット ファイル接続の [全般] ページ](../../integration-services/import-export-data/media/flat-file-connection-general.png)  

### <a name="options-to-specify-general-page"></a>指定するオプション (**[全般]** ページ)

 **[ファイル名]**  
 フラット ファイルのパスと名前を入力します。  
  
 **[参照]**  
 フラット ファイルの場所を特定します。  
  
 **ロケール**  
 ロケールを指定して、順序付けおよび日時の形式に関する言語固有の情報を提供します。  
  
 **Unicode**  
 ファイルで Unicode を使用するかどうかを指定します。 Unicode を使用する場合は、コード ページを指定できません。  
  
 **コード ページ**  
 非 Unicode テキストのコード ページを指定します。  
  
 **形式**  
 区切り記号形式、固定幅形式、または幅合わせしない形式をファイルで使用するかどうかを選択します。  
  
|値|説明|  
|-----------|-----------------|  
|区切り記号|列は区切り記号で区切られます。 **[列]** ページに区切り記号を指定します。|  
|固定幅ファイル|列は固定幅を持ちます。|  
|[幅合わせしない]|幅合わせしないファイルとは、最後の列以外のすべての列が固定幅を持つファイルです。最後の列は、行区切り記号で区切られます。|  
  
 **テキスト修飾子**  
 ファイルで使用するテキスト修飾子を必要に応じて指定します。 たとえば、テキスト フィールドを引用符で囲むことを指定できます。 (このプロパティは、区切りファイルにのみ適用されます。) 
  
> [!NOTE]
> テキスト修飾子を選択した後で、**[なし]** オプションを再度選択することはできません。 テキスト修飾子の選択を解除するには、「 **なし** 」と入力します。  
  
 **[ヘッダー行区切り記号]**  
 ヘッダー行の区切り記号の一覧から選択するか、区切り記号テキストを入力します。  
  
|値|説明|  
|-----------|-----------------|  
|**{CR}{LF}**|ヘッダー行は、復帰と改行の組み合わせで区切られます。|  
|**{CR}**|ヘッダー行は、復帰で区切られます。|  
|**{LF}**|ヘッダー行は、改行で区切られます。|  
|**[セミコロン {;}]**|ヘッダー行は、セミコロンで区切られます。|  
|**[コロン {:}]**|ヘッダー行は、コロンで区切られます。|  
|**[コンマ {,}]**|ヘッダー行は、コンマで区切られます。|  
|**[タブ {t}]**|ヘッダー行は、タブで区切られます。|  
|**[縦棒 {&#124;}]**|ヘッダー行は、縦棒で区切られます。|  
  
 **[スキップするヘッダー行数]**  
 必要に応じて、ファイルの先頭でスキップする行の数を指定します。  
  
 **[先頭データ行を列名として使用する]**  
 最初の行 (スキップされた行の後の) に列名を含めるかどうかを指定します。

## <a name="columns-page---format--delimited-source"></a>[列] ページ - 形式 = 区切り記号 (ソース)
 **[列]** ページでは、ウィザードによって識別された列と区切り記号の一覧を確認できます。 次のスクリーン ショットは、フラット ファイル形式として **[区切り記号]** を選択したときに表示されるページです。
 
![フラット ファイル、区切り記号、[列] ページ](../../integration-services/import-export-data/media/flat-file-delimited-columns-page.jpg)

### <a name="options-to-specify-columns-page---format--delimited"></a>指定するオプション (**[列]** ページ - 形式 = 区切り記号)

 **[行区切り記号]**  
 使用できる行区切り記号の一覧から選択するか、区切り記号テキストを入力します。  
  
|値|説明|  
|-----------|-----------------|  
|**{CR}{LF}**|行は、復帰と改行の組み合わせで区切られます。|  
|**{CR}**|行は、復帰で区切られます。|  
|**{LF}**|行は、改行で区切られます。|  
|**[セミコロン {;}]**|行は、セミコロンで区切られます。|  
|**[コロン {:}]**|行は、コロンで区切られます。|  
|**[コンマ {,}]**|行は、コンマで区切られます。|  
|**[タブ {t}]**|行は、タブで区切られます。|  
|**[縦棒 {&#124;}]**|行は、縦棒で区切られます。|  
  
 **列区切り記号**  
 使用できる列区切り記号の一覧から選択するか、区切り記号テキストを入力します。  
  
|値|説明|  
|-----------|-----------------|  
|**{CR}{LF}**|列は、復帰と改行の組み合わせで区切られます。|  
|**{CR}**|列は、復帰で区切られます。|  
|**{LF}**|列は、改行で区切られます。|  
|**[セミコロン {;}]**|列は、セミコロンで区切られます。|  
|**[コロン {:}]**|列は、コロンで区切られます。|  
|**[コンマ {,}]**|列は、コンマで区切られます。|  
|**[タブ {t}]**|列は、タブで区切られます。|  
|**[縦棒 {&#124;}]**|列は、縦棒で区切られます。|  
  
 **[プレビュー]**  
 フラット ファイル内のサンプル データを、選択されたオプションに基づいて列と行に分割して表示します。  
 
 **[更新]**  
 スキップする区切り記号を変更したときの効果を表示するには、 **[最新の情報に更新]** をクリックします。 このボタンは、他の接続オプションを変更した場合にのみ表示されます。  
  
 **[列のリセット]**  
 元の列を復元します。  

## <a name="columns-page---format--fixed-width-source"></a>[列] ページ - 形式 = 固定幅 (ソース)
**[列]** ページでは、ウィザードによって識別された列と区切り記号の一覧を確認できます。 次のスクリーン ショットは、フラット ファイル形式として **[固定幅]** を選択したときに表示されるページです。
  
![フラット ファイル、固定幅、[列] ページ](../../integration-services/import-export-data/media/flat-file-fixed-width-columns-page.jpg)

### <a name="options-to-specify-columns-page---format--fixed-width"></a>指定するオプション (**[列]** ページ - 形式 = 固定幅)

 **フォント**  
 プレビュー データの表示に使用するフォントを選択します。  
  
 **[変換元データ列]**  
 行の幅を調整するには、赤い垂直行マーカーをスライドさせます。列の幅を調整するには、プレビュー ウィンドウの最上部のルーラーをクリックします。  
  
 **[行幅]**  
 個々の列に対して区切り記号を追加する前に、行の長さを指定します。 または、プレビュー ウィンドウの赤い垂直線をドラッグして行の終わりをマークします。 行幅値は自動的に更新されます。  
  
 **[列のリセット]**  
 元の列を復元します。  
  
## <a name="columns-page---format--ragged-right-source"></a>[列] ページ - 形式 = 幅合わせしない (ソース)
**[列]** ページでは、ウィザードによって識別された列と区切り記号の一覧を確認できます。 次のスクリーン ショットは、フラット ファイル形式として **[幅合わせしない]** を選択したときに表示されるページです。

> [!NOTE]
> 幅合わせしないファイルとは、最後の列以外のすべての列が固定幅を持つファイルです。最後の列は、行区切り記号で区切られます。  
 
![フラット ファイル、幅合わせしない、[列] ページ](../../integration-services/import-export-data/media/flat-file-ragged-right-columns-page.jpg)

### <a name="options-to-specify-columns-page---format--ragged-right"></a>指定するオプション (**[列]** ページ - 形式 = 幅合わせしない)
   
 **フォント**  
 プレビュー データの表示に使用するフォントを選択します。  
  
 **[変換元データ列]**  
 行の幅を調整するには、赤い垂直行マーカーをスライドさせます。列の幅を調整するには、プレビュー ウィンドウの最上部のルーラーをクリックします。  
  
 **[行区切り記号]**  
 使用できる行区切り記号の一覧から選択するか、区切り記号テキストを入力します。  
  
|値|説明|  
|-----------|-----------------|  
|**{CR}{LF}**|行は、復帰と改行の組み合わせで区切られます。|  
|**{CR}**|行は、復帰で区切られます。|  
|**{LF}**|行は、改行で区切られます。|  
|**[セミコロン {;}]**|行は、セミコロンで区切られます。|  
|**[コロン {:}]**|行は、コロンで区切られます。|  
|**[コンマ {,}]**|行は、コンマで区切られます。|  
|**[タブ {t}]**|行は、タブで区切られます。|  
|**[縦棒 {&#124;}]**|行は、縦棒で区切られます。|  
  
 **[列のリセット]**  
 元の列を復元します。  

## <a name="advanced-page-source"></a>[詳細設定] ページ (ソース)
**[詳細設定]** ページには、データ ソース内の各列に関する詳細情報が表示されます (データの型とサイズを含む)。 次のスクリーン ショットは、区切りフラット ファイル内の最初の列に対する **[詳細設定]** ページです。

![フラット ファイル、区切り形式、[詳細設定] ページ](../../integration-services/import-export-data/media/flat-file-delimited-advanced-page.jpg)

スクリーン ショットでは、数値を含む **[id]** 列で、最初にくるのが文字列のデータ型であることに注目してください。

### <a name="options-to-specify-advanced-page"></a>指定するオプション (**[詳細設定]** ページ)

 **[各列のプロパティを構成します。]**  
 左側のペインで列を選択すると、そのプロパティが右側のペインに表示されます。 列プロパティの説明については、次の表を参照してください。 一覧されたプロパティの中には、特定のフラット ファイル形式に対してのみ構成可能なもの、および特定のデータ型の列に対してのみ構成可能なものがあります。  
  
|プロパティ|説明|  
|--------------|-----------------|  
|**Name**|わかりやすい列名を指定します。 名前を入力しないと、[!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] によって、列 0、列 1 などの形式で自動的に名前が作成されます。|
|**[列区切り記号]**|使用できる列区切り記号の一覧から、列区切り記号を選択します。 テキストに出現しないと思われる区切り記号を選択してください。 固定幅列の場合、この値は無視されます。<br /><br /> **{CR}{LF}** 。 列は、復帰と改行の組み合わせで区切られます。<br /><br /> **{CR}** 。 列は、復帰で区切られます。<br /><br /> **{LF}** 。 列は、改行で区切られます。<br /><br /> **セミコロン {;}** 。 列は、セミコロンで区切られます。<br /><br /> **コロン {:}** 。 列は、コロンで区切られます。<br /><br /> **コンマ {,}** 。 列は、コンマで区切られます。<br /><br /> **タブ {t}** 。 列は、タブで区切られます。<br /><br /> **縦棒 {&#124;}** 。 列は、縦棒で区切られます。|
|**[列の型]**|列が区切り形式、固定幅形式、幅合わせしない形式のうちどれであるかを示します。 このプロパティは読み取り専用です。 幅合わせしない形式のファイルとは、最後の列を除くすべての列が固定幅のファイルです。 最後の列は、行区切り記号で区切られます。|  
|**[入力列の幅]**|格納する値をバイト数で指定します。Unicode ファイルの場合、この値は文字数となります。 区切られた列の場合、この値は無視されます。<br /><br /> **注** オブジェクト モデルでは、このプロパティの名前は ColumnWidth です。|
|**[データ精度]**|数値データの精度を指定します。 精度とは、桁数です。|
|**[データ スケール]**|数値データの小数点以下の精度を指定します。 これは小数点以下の桁数を表します。|
|**DataType**|使用できるデータ型を一覧から選択します。<br/>詳細については、「 [Integration Services Data Types](../../integration-services/data-flow/integration-services-data-types.md)」を参照してください。|
|**[出力列の幅]**|格納する値をバイト数で指定します。Unicode ファイルの場合、この値は文字数に対応します。 データ フロー タスクでは、この値を使用してフラット ファイル ソースの出力列の幅を設定します。 オブジェクト モデルでは、このプロパティの名前は MaximumWidth です。|  
|**[テキスト修飾子]**|テキスト データが引用符などのテキスト修飾子文字で囲まれているかどうかを示します。<br /><br /> True: フラット ファイルのテキスト データは修飾されます。 False: フラット ファイルのテキスト データは修飾されません。|  
  
**[新規作成]**  
 **[新規作成]** をクリックして新しい列を追加します。 既定では、 **[新規作成]** ボタンをクリックすると、新しい列がリストの末尾に追加されます。 さらにこのボタンのドロップダウン リストには、次のオプションがあります。  
  
|値|説明|  
|-----------|-----------------|  
|**[列の追加]**|新しい列をリストの末尾に追加します。|  
|**[前に挿入]**|選択した列の前に新しい列を追加します。|  
|**[後に挿入]**|選択した列の後に新しい列を追加します。|  
  
 **削除**  
 列を選択して **[削除]** をクリックすると、列が削除されます。  
  
 **[型の推測]**  
 **[列の型の推測]** ダイアログ ボックスを使用して、ファイルのサンプル データを評価し、各列のデータ型と長さの推測を取得します。  
 
**[型の推測]** をクリックすると、**[列の型の推測]** ダイアログ ボックスが表示されます。 

![フラット ファイル接続の [型の推測] ダイアログ ボックス](../../integration-services/import-export-data/media/flat-file-connection-suggest.png)

**[列の型の推測]** ダイアログ ボックスでオプションを選択した後、**[OK]** をクリックすると、列のデータ型がウィザードによって一部変更される場合があります。

次のスクリーン ショットでは、**[型の推測]** をクリックした後で、データ ソースの **id** 列が実際にはテキスト文字列ではなく、数値であることがウィザードによって認識され、列のデータ型が文字列から整数に変更されています。

![フラット ファイル接続の詳細設定の変更後](../../integration-services/import-export-data/media/flat-file-connection-advanced-after.png)

詳細については、「[[列の型の推測] ダイアログ ボックスの UI リファレンス](../../integration-services/connection-manager/suggest-column-types-dialog-box-ui-reference.md)」を参照してください。

## <a name="preview-page-source"></a>[プレビュー] ページ (ソース)

**[プレビュー]** ページでは、列とサンプル データの一覧を見て、内容が目的どおりであることを確認できます。

![フラット ファイル、[プレビュー] ページ](../../integration-services/import-export-data/media/flat-file-preview-page.jpg)

### <a name="options-to-specify-preview-page"></a>指定するオプション (**[プレビュー]** ページ)

 **[スキップするデータ行数]**  
 フラット ファイルの冒頭でスキップする行数を指定します。  
  
 **[プレビュー]**  
 フラット ファイル内のサンプル データを、選択したオプションに基づいて列と行に分割して表示します。
 
 **[更新]**  
 **[最新の情報に更新]** をクリックすると、スキップする行数を変更した結果が表示されます。 このボタンは、他の接続オプションを変更した場合にのみ表示されます。  
 
**[プレビュー]** ページの詳細については、Integration Services リファレンス ページ「[[フラット ファイル接続マネージャー エディター] &#40;[プレビュー] ページ&#41;](../connection-manager/flat-file-connection-manager.md)」を参照してください。

## <a name="connect-to-a-flat-file-destination"></a>フラット ファイル変換先に接続する
フラット ファイル変換先の場合は、次のスクリーン ショットに示すように、オプションに関するページは 1 ページのみとなります。 ファイルを参照して選択し、**[形式]** セクションで設定を確認します。

![フラット ファイル変換先に接続する](../../integration-services/import-export-data/media/connect-to-flat-file-destination.jpg)

### <a name="options-to-specify-choose-a-destination-page"></a>指定するオプション (**[変換先]** ページ)

 **[ファイル名]**  
 フラット ファイルのパスと名前を入力します。  
  
 **[参照]**  
 フラット ファイルの場所を特定します。  
  
 **ロケール**  
 ロケールを指定して、順序付けおよび日時の形式に関する言語固有の情報を提供します。  
  
 **Unicode**  
 ファイルで Unicode を使用するかどうかを指定します。 Unicode を使用する場合は、コード ページを指定できません。  
  
 **コード ページ**  
 非 Unicode テキストのコード ページを指定します。  
  
 **形式**  
 区切り記号形式、固定幅形式、または幅合わせしない形式をファイルで使用するかどうかを選択します。  
  
|値|説明|  
|-----------|-----------------|  
|区切り記号|列は区切り記号で区切られます。 **[列]** ページに区切り記号を指定します。|  
|固定幅ファイル|列は固定幅を持ちます。|  
|[幅合わせしない]|幅合わせしないファイルとは、最後の列以外のすべての列が固定幅を持つファイルです。最後の列は、行区切り記号で区切られます。|  
  
 **テキスト修飾子**  
 ファイルで使用するテキスト修飾子を必要に応じて指定します。 たとえば、テキスト フィールドを引用符で囲むことを指定できます。 (このプロパティは、区切りファイルにのみ適用されます。) 
  
> [!NOTE] 
> テキスト修飾子を選択した後で、 **[なし]** オプションを再度選択することはできません。 テキスト修飾子の選択を解除するには、「 **なし** 」と入力します。  

## <a name="see-also"></a>参照
[データ ソースの選択](../../integration-services/import-export-data/choose-a-data-source-sql-server-import-and-export-wizard.md)  
[変換先の選択](../../integration-services/import-export-data/choose-a-destination-sql-server-import-and-export-wizard.md)