---
description: 緩やかに変化するディメンション変換
title: 緩やかに変化するディメンション変換 | Microsoft Docs
ms.custom: ''
ms.date: 08/31/2019
ms.prod: sql
ms.prod_service: integration-services
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql13.dts.designer.slowlychangingdimtrans.f1
helpviewer_keywords:
- Slowly Changing Dimension transformation
- slowly changing dimensions
- SCD transformation
- updating slowly changing dimensions
ms.assetid: f8849151-c171-4725-bd25-f2c33a40f4fe
author: chugugrace
ms.author: chugu
ms.openlocfilehash: e46178bf0929eda71b91c7bec1ee26a7ed2a17fd
ms.sourcegitcommit: cfa04a73b26312bf18d8f6296891679166e2754d
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/19/2020
ms.locfileid: "92195284"
---
# <a name="slowly-changing-dimension-transformation"></a>緩やかに変化するディメンション変換

[!INCLUDE[sqlserver-ssis](../../../includes/applies-to-version/sqlserver-ssis.md)]


  緩やかに変化するディメンション変換は、データ ウェアハウスのディメンション テーブル内にある、レコードの更新および挿入を調整します。 たとえば、この変換を使用すると、AdventureWorks OLTP データベースの Production.Products テーブルにあるデータを使って [!INCLUDE[ssSampleDBDWobject](../../../includes/sssampledbdwobject-md.md)] データベースの DimProduct テーブルに挿入や更新を行う変換出力を構成できます。  
  
> [!IMPORTANT]  
>  緩やかに変化するディメンション ウィザードでは、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]への接続のみがサポートされます。  
  
 緩やかに変化するディメンション変換には、緩やかに変化するディメンションを管理するための、次の機能が用意されています。  
  
-   受信した行を参照テーブル内の行と照合し、新しい行および既存の行を識別します。  
  
-   変更が許可されていない場合に、変更が含まれる受信行を識別します。  
  
-   更新が必要な推定メンバー レコードを識別します。  
  
-   新しいレコードの挿入や有効期限が切れたレコードの更新が必要な、履歴に変更のある受信行を識別します。  
  
-   有効期限が切れたレコードなど、既存のレコードの更新が必要となる変更が含まれる受信行を検出します。  
  
 緩やかに変化するディメンション変換では、変化する属性、履歴属性、固定属性、および推定メンバーの、4 つの変更の種類がサポートされています。  
  
-   変化する属性の変更は、既存のレコードを上書きします。 この変更の種類は、種類 1 の変更に相当します。 緩やかに変化するディメンション変換は、これらの行を **[変化する属性更新の出力]** という名前の出力に送信します。  
  
-   履歴属性の変更は、既存のレコードを更新するのではなく、新しいレコードを作成します。 既存のレコードに許可されている変更は、そのレコードが現在のレコードか、または有効期限が切れているかを示す列の更新のみです。 この変更の種類は、種類 2 の変更に相当します。 緩やかに変化するディメンション変換は、これらの列を、 **[履歴属性挿入の出力]** および **[新しい出力]** の 2 つの出力に送信します。  
  
-   固定属性の変更は、列の値が変更できないことを示します。 緩やかに変化するディメンション変換は、変更を検出し、変更のあった行を **[固定属性の出力]** という名前の出力に送信します。  
  
-   推定メンバーは、行がディメンション テーブル内の推定メンバー レコードであることを示します。 推定メンバーは、まだ読み込まれていないディメンション メンバーをファクト テーブルで参照するときに使用されます。 推定メンバーの最小レコードは、後続のディメンション データを読み込む中で提供される、関連するディメンション データを予測して作成されます。 緩やかに変化するディメンション変換は、これらの行を **[推定メンバー更新の出力]** という名前の出力に送信します。 推定メンバーのデータが読み込まれると、新しいレコードを作成する代わりに、既存のレコードを更新できます。  
  
> [!NOTE]  
>  緩やかに変化するディメンション変換では、種類 3 の変更はサポートされません。この変更は、ディメンション テーブルを変更する必要があるためです。 列を固定属性の更新の種類と見なすことにより、種類 3 の変更の対象となるデータ値をキャプチャできます。  
  
 緩やかに変化するディメンション変換は、実行時、まず受信行を参照テーブル内のレコードと照合します。 一致するものがない場合、受信行が新しいレコードになります。つまり、緩やかに変化するディメンション変換は追加の作業を実行せず、その行を **[新しい出力]** に出力します。  
  
 一致するものがある場合、緩やかに変化するディメンション変換は、行に変更が含まれているかどうかを検出します。 行に変更が含まれる場合、緩やかに変化するディメンション変換は各列の更新の種類を識別し、その行を **[変化する属性更新の出力]**、 **[固定属性の出力]**、 **[履歴属性挿入の出力]**、または **[推定メンバー更新の出力]** に出力します。 行が変更されていない場合、緩やかに変化するディメンション変換は、その行を **[変更されていない出力]** に出力します。  
  
## <a name="slowly-changing-dimension-transformation-outputs"></a>緩やかに変化するディメンション変換の出力  
 緩やかに変化するディメンション変換は、1 つの入力と、最大 6 つの出力をとります。 出力は、行の更新および挿入の要件に対応するデータ フローのサブセットに行を出力します。 この変換では、エラー出力はサポートされていません。  
  
 次の表では、変換出力および後続のデータ フローの要件について説明します。 要件では、緩やかに変化するディメンション ウィザードが作成するデータ フローについて説明します。  
  
|出力|説明|データ フロー要件|  
|------------|-----------------|----------------------------|  
|**[変化する属性更新の出力]**|参照テーブル内のレコードが更新されます。 この出力は、変化する属性の行に使用されます。|OLE DB コマンド変換は、UPDATE ステートメントを使用してレコードを更新します。|  
|**[固定属性の出力]**|変更できない行の値と、参照テーブルの値が一致しない場合の出力です。 この出力は、固定属性の行に使用されます。|既定のデータ フローは作成されません。 この変換が、固定属性の列への変更を検出した後も続行するように構成されている場合、これらの行をキャプチャするデータ フローを作成する必要があります。|  
|**[履歴属性挿入の出力]**|参照テーブルには、一致する行が少なくとも 1 行は含まれています。 "現在" としてマークされていた行は、"期限切れ" としてマークされます。 この出力は、履歴属性の行に使用されます。|派生列変換は、有効期限が切れた行および現在の行のインジケーターに対する列を作成します。 OLE DB コマンド変換は、"期限切れ" としてマークされたレコードを更新します。 新しい列値を持つ行は [新しい出力] に出力され、[新しい出力] でその行が挿入されて "現在" としてマークされます。|  
|**[推定メンバー更新の出力]**|推定ディメンション メンバーの行が挿入されます。 この出力は、推定メンバーの行に使用されます。|OLE DB コマンド変換は、SQL UPDATE ステートメントを使用してレコードを更新します。|  
|**[新しい出力]**|参照テーブルに、一致する行が含まれない場合の出力です。 行は、ディメンション テーブルに追加されます。 この出力は新しい行に使用され、履歴属性の行に変更されます。|派生列変換は、現在の行のインジケーターを設定し、OLE DB 変換先は、行を挿入します。|  
|**[変更されていない出力]**|参照テーブル内の値と、行の値が一致する場合の出力です。 この出力は、変更されていない行に使用されます。|緩やかに変化するディメンション変換は作業を実行しないため、既定のデータ フローは作成されません。 これらの行をキャプチャする場合は、この出力に対するデータ フローを作成する必要があります。|  
  
## <a name="business-keys"></a>ビジネス キー  
 緩やかに変化するディメンション変換には、少なくとも 1 つのビジネス キー列が必要です。  
  
 緩やかに変化するディメンション変換では、NULL 値のビジネス キーはサポートされていません。 データに、ビジネス キー列が NULL の行が含まれている場合、これらの行は、データ フローから削除できません。 条件分割変換を使用すると、ビジネス キー列に NULL 値が含まれている行をフィルター選択できます。 詳細については、「 [Conditional Split Transformation](../../../integration-services/data-flow/transformations/conditional-split-transformation.md)」を参照してください。  
  
## <a name="optimizing-the-performance-of-the-slowly-changing-dimension-transformation"></a>緩やかに変化するディメンション変換のパフォーマンスの最適化  
 緩やかに変化するディメンション変換のパフォーマンスを向上するための推奨方法については、「 [データ フロー パフォーマンス機能](../../../integration-services/data-flow/data-flow-performance-features.md)」を参照してください。  
  
## <a name="troubleshooting-the-slowly-changing-dimension-transformation"></a>緩やかに変化するディメンション変換のトラブルシューティング  
 緩やかに変化するディメンション変換による外部データ プロバイダーの呼び出しをログに記録できます。 このログ機能を使用すると、緩やかに変化するディメンション変換による外部データ ソースへの接続、コマンド、およびクエリに関するトラブルシューティングを行うことができます。 緩やかに変化するディメンション変換による外部データ プロバイダーの呼び出しのログを記録するには、パッケージ ログ記録を有効にして、パッケージ レベルで **Diagnostic** イベントを選択する必要があります。 詳細については、「 [パッケージ実行のトラブルシューティング ツール](../../../integration-services/troubleshooting/troubleshooting-tools-for-package-execution.md)」を参照してください。  
  
## <a name="configuring-the-slowly-changing-dimension-transformation"></a>緩やかに変化するディメンション変換の構成  
 プロパティを設定するには [!INCLUDE[ssIS](../../../includes/ssis-md.md)] デザイナーから行うか、またはプログラムによって設定します。  
  
 **[詳細エディター]** ダイアログ ボックスまたはプログラムで設定できるプロパティの詳細については、次のトピックのいずれかを参照してください。  
  
-   [Common Properties](../set-the-properties-of-a-data-flow-component.md)  
  
-   [変換のカスタム プロパティ](../../../integration-services/data-flow/transformations/transformation-custom-properties.md)  
  
 プロパティの設定方法の詳細については、「 [データ フロー コンポーネントのプロパティを設定する](../../../integration-services/data-flow/set-the-properties-of-a-data-flow-component.md)」を参照してください。  
  
## <a name="configuring-the-slowly-changing-dimension-transformation-outputs"></a>緩やかに変化するディメンション変換の出力の構成  
 ディメンション テーブル内のレコードの更新および挿入を調整する作業は、特に種類 1 と種類 2 の変更の両方が使用される場合、複雑なタスクとなることがあります。 [!INCLUDE[ssIS](../../../includes/ssis-md.md)] デザイナーでは、緩やかに変化するディメンションのサポートを構成する方法が、2 種類用意されています。  
  
-   接続を選択する **[詳細エディター]** ダイアログ ボックスでは、共通コンポーネントおよびカスタム コンポーネントのプロパティの設定、入力列の選択、および 6 つの出力における列プロパティの設定を行うことができます。 緩やかに変化するディメンションのサポートを構成するタスクを完了するには、緩やかに変化するディメンション変換が使用する出力用のデータ フローを、手動で作成する必要があります。 詳細については、「 [Data Flow](../../../integration-services/data-flow/data-flow.md)」を参照してください。  
  
-   ディメンションの読み込みウィザードを使用すると、緩やかに変化するディメンション変換を構成し、変換出力用のデータ フローを構築できます。 緩やかに変化するディメンションの構成を変更するには、ディメンションの読み込みウィザードを再実行します。 詳細については、「 [緩やかに変化するディメンション ウィザードを使用して出力を構成する](../../../integration-services/data-flow/transformations/configure-outputs-using-the-slowly-changing-dimension-wizard.md)」を参照してください。  
  
## <a name="related-tasks"></a>Related Tasks  
 [データ フロー コンポーネントのプロパティを設定する](../../../integration-services/data-flow/set-the-properties-of-a-data-flow-component.md)  
  
## <a name="related-content"></a>関連コンテンツ  
  
-   [SSIS で緩やかに変化するディメンションを処理する](https://techcommunity.microsoft.com/t5/SQL-Server-Integration-Services/Handling-Slowly-Changing-Dimensions-in-SSIS/ba-p/387599)
-   [緩やかに変化するディメンション ウィザードを最適化する](https://techcommunity.microsoft.com/t5/SQL-Server-Integration-Services/Optimizing-the-Slowly-Changing-Dimension-Wizard/ba-p/387702)
  
