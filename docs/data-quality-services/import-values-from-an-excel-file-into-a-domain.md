---
description: 値を Excel ファイルからドメインへインポートする
title: 値を Excel ファイルからドメインへインポートする
ms.date: 03/01/2017
ms.prod: sql
ms.prod_service: data-quality-services
ms.reviewer: ''
ms.technology: data-quality-services
ms.topic: conceptual
f1_keywords:
- sql13.dqs.kb.importfailing.f1
- sql13.dqs.kb.importselect.f1
- sql13.dqs.kb.failingvalues.f1
ms.assetid: 04cde693-2043-477f-8417-fcc463ca7195
author: swinarko
ms.author: sawinark
ms.openlocfilehash: bf2b2f9d6b2f3ad72121db25758b2258363d8566
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/17/2020
ms.locfileid: "88431334"
---
# <a name="import-values-from-an-excel-file-into-a-domain"></a>値を Excel ファイルからドメインへインポートする

[!INCLUDE [SQL Server - Windows only ASDBMI  ](../includes/applies-to-version/sqlserver.md)]

  このトピックでは、 [!INCLUDE[ssDQSnoversion](../includes/ssdqsnoversion-md.md)] (DQS) で Excel ファイルからドメインにデータをインポートする方法について説明します。 Excel ファイルを使用して [!INCLUDE[ssDQSClient](../includes/ssdqsclient-md.md)] アプリケーションにドメイン値をインポートすることで、ナレッジの生成処理を簡略化し、時間と労力を節約します。 この処理では、有効なデータ値の一覧が保存された Excel ファイルまたはテキスト ファイルを使用して、それらの値をドメインにインポートすることができます。 Excel ファイルからドメインにドメイン値をインポートしたり、ナレッジ ベースにドメインをインポートしたりできます (ナレッジベースへのドメインのインポートの詳細については、「 [ナレッジ検出で Excel ファイルからドメインをインポートする](../data-quality-services/import-domains-from-an-excel-file-in-knowledge-discovery.md) 」を参照してください)。Excel ファイルへのエクスポートはサポートされていません。  
  
 データ値は、次の 2 とおりの方法でインポートできます。  
  
-   新しいドメインを作成し、Excel ファイルからそのドメインに値をインポートします。この場合、すべての値がドメインに追加されます。  
  
-   値が含まれている既存のドメインに値をインポートします。この場合、新しい値だけがインポートされます。 既に含まれている値はインポートされません。  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> はじめに  
  
###  <a name="prerequisites"></a><a name="Prerequisites"></a> 前提条件  
 Excel ファイルからドメイン値または完全なドメインをインポートするには、 [!INCLUDE[ssDQSClient](../includes/ssdqsclient-md.md)] アプリケーションがインストールされているコンピューターに Excel がインストールされていること、ドメイン値を含む Excel ファイルが作成されていること (「 [How the import works](#How)」を参照)、およびドメインをインポートするナレッジ ベースが作成されていて開いていることが必要です。  
  
###  <a name="security"></a><a name="Security"></a> セキュリティ  
  
####  <a name="permissions"></a><a name="Permissions"></a> Permissions  
 Excel ファイルからドメイン値をインポートするには、DQS_MAIN データベースの dqs_kb_editor ロールまたは dqs_administrator ロールが必要です。  
  
##  <a name="import-values-from-an-excel-file-into-a-domain"></a><a name="Import"></a> Excel ファイルからドメインに値をインポートする  
  
1.  [!INCLUDE[ssDQSInitialStep](../includes/ssdqsinitialstep-md.md)][Data Quality Client アプリケーションを実行](../data-quality-services/run-the-data-quality-client-application.md)します。  
  
2.  [!INCLUDE[ssDQSClient](../includes/ssdqsclient-md.md)] のホーム画面で、ドメイン管理アクティビティ内のナレッジ ベースを開きます。  
  
3.  新しいドメインに値を追加する場合は、 **[ドメインの作成]** アイコンを使用して新しいドメインを作成し、ドメイン リストで新しいドメインを選択します。  
  
4.  既存のドメインに値を追加する場合は、ドメイン リストでドメインを選択します。  
  
5.  **[ドメイン値]** タブをクリックし、アイコン バーの **[値をインポートします]** アイコンをクリックし、 **[Excel から有効な値をインポートします]** をクリックします。  
  
6.  **[ドメイン値のインポート]** ダイアログ ボックスで、 **[参照]** をクリックします。  
  
7.  **[ファイルを選択します]** ダイアログ ボックスで、ドメイン値のインポート元の Excel ファイルが格納されているフォルダーに移動し、ファイル (拡張子が .xlsx、.xls、または .csv のファイル) を選択して **[開く]** をクリックします。 選択するファイルは、DQS を実行しているクライアント上のファイルか、ユーザーがアクセスできる共有ファイルでなければなりません。  
  
8.  **[ワークシート]** ボックスの一覧で、インポートするワークシートを選択します。  
  
9. ワークシートの先頭の行がドメイン名を表し、残りのすべての行が有効なドメイン値を表す場合は、 **[先頭の行を見出しとして使用]** をオンにします。  
  
10. **[OK]** をクリックします。 進行状況バーに、正常にインポートされた値の数、インポートされなかった値の数、および値の総数が表示されます。 処理を取り消すには、 **[キャンセル]** ボタンをクリックします。  
  
11. **[ドメイン値のインポート]** ダイアログ ボックスに "インポート完了" と表示されていることを確認します。 このダイアログ ボックスで、正常にインポートされた値とインポートされなかった値を確認します。 ファイルの名前とパス、処理の完了状態、正常にインポートされた値の数、インポートされなかった値の数、および処理された値の総数が表示されます。  
  
12. 正常にインポートされなかった値について、**[ログ]** をクリックして **[ドメイン値のインポート - 問題のある失敗]** ダイアログ ボックスを表示し、インポート操作が失敗した理由を確認します。 **[問題のある値]** 列に、Excel ファイルからドメインにインポートできなかった値が表示され、 **[理由]** 列に、インポートが失敗した理由が表示されます。 **[クリップボードにコピー]** をクリックすると、 **[問題のある値]** のテーブルをクリップボードにコピーし、Excel のワークシートやメモ帳のファイルなど、別のプログラムにコピーできます。 **[OK]** をクリックして **[問題のある値]** ダイアログ ボックスを閉じます。  
  
13. **[OK]** をクリックしてインポート操作を完了し、ダイアログ ボックスを閉じます。 インポートが正常に完了すると、 **[ドメイン値]** ページのドメイン値の一覧が更新され、インポートされた新しい値が表示されます。 フィルターが **[すべての値]** に変わり、 **[新規のみ表示]** が選択されます。 インポート操作の完了後に **[新規のみ表示]** を選択すると、Excel ファイルからインポートされた値だけが表示されます。  
  
14. **[完了]** をクリックしてナレッジ ベースに値を追加します。  
  
##  <a name="follow-up-after-importing-values-from-an-excel-file-into-a-domain"></a><a name="FollowUp"></a> 補足情報: Excel ファイルからドメインに値をインポートした後  
 ドメインに値をインポートした後、ドメインで他のドメイン管理タスクを実行したり、ナレッジ検出を実行してナレッジをドメインに追加したり、照合ポリシーをドメインに追加することができます。 詳しくは、「[ナレッジ検出の実行](../data-quality-services/perform-knowledge-discovery.md)」、「[ドメインの管理](../data-quality-services/managing-a-domain.md)」、または「[照合ポリシーの作成](../data-quality-services/create-a-matching-policy.md)」をご覧ください。  
  
##  <a name="importing-synonyms"></a><a name="Synonyms"></a> シノニムのインポート  
 シノニムのインポートの動作は次のとおりです。  
  
-   先にすべての値がインポートされてから、シノニムの関連付けが確立されます。  
  
-   シノニムの値を関連付けることができない場合、ログ画面にエラーが表示されます。 ファイル内の先頭の値とシノニムをドメインにインポートしても、シノニムとして設定されない場合があります。  
  
 シノニムの関連付けを設定するプロセスに関しては、次の点に注意してください。  
  
-   Excel ファイルの先頭の値が別の値のシノニムとして既にドメインに存在する場合 (たとえば、Excel ファイルで値 B の先頭の値として想定している値 A が、ドメインで値 C のシノニムになっている場合)、シノニムを手動で設定する必要があります。 インポートの完了後にシノニムを手動で設定する方法のほかに、現在シノニムとして設定されている値の関連付け (たとえば、上記の値 A と値 C の関連付け) を解除してからファイルをインポートすることもできます。  
  
-   シノニムが既に別の先頭の値に関連付けられている場合、シノニムを手動で設定する必要があります。  
  
-   アプリケーションで何かの理由により手動で値を関連付けることができない場合、インポート操作で適用されません。  
  
##  <a name="how-the-import-works"></a><a name="How"></a> インポートのしくみ  
 インポート操作でインポートされる値を次に示します。  
  
 DQS のインポート操作では、Excel ファイルからのインポートが次のように実行されます。  
  
-   正しい値と新しい値がインポートされます。 インポートされたドメイン値が既に 1 つ以上存在する場合、その値はインポートされません。  
  
-   ドメイン ルールと矛盾する値は、無効な値としてインポートされます。  
  
-   値がドメインのデータ型と異なる場合や null である場合、その値はファイルからインポートされません。  
  
-   値はファイル内と同じ順序でインポートされます。  
  
-   各行はドメイン値を表します。  
  
-   先頭の行は、 **[先頭の行を見出しとして使用]** チェック ボックスの設定に応じて、ドメインを表すか、最初のデータ値またはレコードになる .xslx ファイルまたは .xls ファイルを使用する場合に **[先頭の行を見出しとして使用]** をオンにすると、null の列名は自動的に F*n*に変換され、重複する列には番号が付加されます。  
  
-   インポート操作を完了前に取り消した場合、操作がロールバックされ、データはインポートされません。  
  
-   最初の列の値はドメインにインポートされます。 最初の列のほかに 1 つ以上の列を追加する場合、それらの列の値はシノニムとして追加されます (「 [シノニムのインポート](#Synonyms)」を参照してください)。  
  
    -   最初の列が先頭の値と見なされ、2 列目以降はシノニムと見なされます。  
  
    -   シノニムが複数ある場合、1 つの行でインポートすることも、複数の行に分けてインポートすることもできます。 たとえば、"NYC" と "New York City" を "New York" のシノニムとしてインポートする場合、1 列目が "New York"、2 列目が "NYC"、3 列目が "New York City" の 1 つの行をインポートできます。また、2 行に分けて、1 列目が "New York" で 2 列目が "NYC" の行と、1 列名が "New York" で 2 列目が "New York City" の行をインポートすることもできます。 値 "New York" がドメインに既に存在する場合は、シノニムだけが追加されることに注意してください。インポート処理中に、値が既に存在することを示すエラーは表示されません。 最初の値が存在しない場合はドメインに追加されます。  
  
 インポートに使用する Excel ファイルには、次のルールが適用されます。  
  
-   Excel ファイルの拡張子は、.xlsx、.xls、または .csv です。 ドメイン値または完全なドメインをインポートするには、 [!INCLUDE[ssDQSClient](../includes/ssdqsclient-md.md)] アプリケーションがインストールされているコンピューターに Microsoft Excel がインストールされている必要があります。 Excel Version 2003 以降がサポートされます。 64 ビット バージョンの Excel を使用する場合は、Excel 2003 ファイルのみがサポートされます。Excel 2007 または 2010 ファイルはサポートされません。  
  
-   64 ビットの Excel では、Excel ファイル タイプ .xlsx はサポートされません。 64 ビットの Excel を使用している場合は、スプレッドシート ファイルを .xls ファイルまたは .csv ファイルとして保存するか、32 ビットの Excel をインストールしてください。  
  
-   .xlsx および .xls ファイルでは、列のデータ型は最初の 8 行に基づいて決定されます。 最初の 8 行に列のデータ型が複数混在している場合、その列のデータ型は文字列になります。 9 行目以降のセルがそのデータ型に従っていない場合、セルの値は null になります。  
  
-   .csv ファイルでは、データ型は最初の 8 行で最も多く使用されているデータ型によって決定されます。  
  
-   Excel ファイルの形式が正しくないか、Excel ファイルが破損している場合は、インポート操作でエラーが発生します。  
  
  
