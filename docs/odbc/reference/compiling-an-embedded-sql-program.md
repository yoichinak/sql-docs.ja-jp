---
description: 埋め込み SQL プログラムのコンパイル
title: Embedded SQL プログラムのコンパイル |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQL [ODBC], embedded SQL
- SQL statements [ODBC], embedded SQL
- compiling embedded SQL programs [ODBC]
- embedded SQL [ODBC]
ms.assetid: 9e94146a-5b80-4a01-b586-1e03ff05b9ac
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 5065d50bd9ae23cc7db8a2310b13792b461da2a5
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/17/2020
ms.locfileid: "88386078"
---
# <a name="compiling-an-embedded-sql-program"></a>埋め込み SQL プログラムのコンパイル
Embedded SQL プログラムには SQL とホストの言語ステートメントが混在しているため、ホスト言語のコンパイラに直接送信することはできません。 代わりに、マルチステップのプロセスを通じてコンパイルされます。 このプロセスは製品によって異なりますが、この手順はすべての製品でほぼ同じです。  
  
 次の図は、embedded SQL プログラムをコンパイルするために必要な手順を示しています。  
  
 ![埋め込み SQL プログラムのコンパイル手順](../../odbc/reference/media/pr02.gif "pr02")  
  
 Embedded SQL プログラムのコンパイルには、次の5つの手順が含まれます。  
  
1.  Embedded SQL プログラムは、プログラミングツールである SQL プリコンパイラに送信されます。 コンパイラはプログラムをスキャンし、埋め込まれた SQL ステートメントを検索して処理します。 DBMS でサポートされているプログラミング言語ごとに異なるプリコンパイラが必要です。 DBMS 製品では、通常、C、Pascal、COBOL、Fortran、Ada、PL/I、各種のアセンブリ言語など、1つ以上の言語用の precompilers が用意されています。  
  
2.  プリコンパイラにより、2つの出力ファイルが生成されます。 最初のファイルはソースファイルで、埋め込まれた SQL ステートメントは削除されます。 代わりに、プリコンパイラは、プログラムと DBMS の間に実行時リンクを提供する独自の DBMS ルーチンへの呼び出しを置き換えます。 通常、これらのルーチンの名前と呼び出しシーケンスは、プリコンパイラと DBMS のみに認識されます。これらは DBMS のパブリックインターフェイスではありません。 2番目のファイルは、プログラムで使用されているすべての埋め込み SQL ステートメントのコピーです。 このファイルは、データベース要求モジュールまたは DBRM と呼ばれることもあります。  
  
3.  プリコンパイラからのソースファイルの出力は、ホストプログラミング言語 (C や COBOL コンパイラなど) の標準コンパイラに送信されます。 コンパイラはソースコードを処理し、オブジェクトコードを出力として生成します。 この手順では、DBMS または SQL とは関係ありません。  
  
4.  リンカーは、コンパイラによって生成されたオブジェクトモジュールを受け入れ、さまざまなライブラリルーチンとリンクし、実行可能プログラムを生成します。 実行可能プログラムにリンクされているライブラリルーチンには、手順 2. で説明した独自の DBMS ルーチンが含まれています。  
  
5.  プリコンパイラによって生成されたデータベース要求モジュールは、特別なバインドユーティリティに送信されます。 このユーティリティは、SQL ステートメントの検証、解析、検証、最適化を行い、ステートメントごとにアクセスプランを生成します。 結果として、埋め込み SQL ステートメントの実行可能バージョンを表すプログラム全体に対するアクセスプランが結合されます。 バインドユーティリティは、データベースにプランを格納します。通常は、このプランを使用するアプリケーションプログラムの名前を割り当てます。 コンパイル時または実行時にこの手順を実行するかどうかは、DBMS によって異なります。  
  
 Embedded SQL プログラムのコンパイルに使用される手順は、「 [Sql ステートメントの処理](../../odbc/reference/processing-a-sql-statement.md)」で説明した手順と非常に密接に関連しています。 特に、プリコンパイラによってホスト言語コードから SQL ステートメントが分離され、バインドユーティリティによって SQL ステートメントが解析および検証され、アクセスプランが作成されることに注意してください。 コンパイル時にステップ5が実行される Dbms では、コンパイル時に SQL ステートメントを処理する最初の4つの手順が実行されます。最後の手順 (実行) は実行時に行われます。 このため、このような Dbms でクエリを実行すると非常に高速になります。
