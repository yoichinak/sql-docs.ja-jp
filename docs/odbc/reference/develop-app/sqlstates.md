---
description: SQLSTATE
title: SQLSTATEs |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- diagnostic information [ODBC], sqlstates
- SQLSTATE [ODBC]
ms.assetid: f29fff2e-3d09-4a8c-a2f9-2059062cbebf
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: b32a965779da1669452e9361e38723e29cfb11ca
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/17/2020
ms.locfileid: "88476394"
---
# <a name="sqlstates"></a>SQLSTATE
SQLSTATEs は、警告またはエラーの原因に関する詳細情報を提供します。 このマニュアルに記載されている SQLSTATEs は、ISO/IEF CLI 仕様に記載されているものに基づいていますが、IM で始まる SQLSTATEs は ODBC に固有のものです。  
  
 リターンコードとは異なり、このマニュアルに記載されている SQLSTATEs はガイドラインであり、ドライバーを返す必要はありません。 そのため、ドライバーは、検出可能なすべてのエラーまたは警告について、適切な SQLSTATE を返す必要がありますが、このような場合には、アプリケーションでカウントされません。 この状況の理由は次のようになります。  
  
-   **Incompleteness**不完全このマニュアルには多数のエラーと警告が表示されますが、これらのエラーや警告の原因として考えられるのは完全ではありません。ドライバーの実装は、単純にあまり変化しません。 特定のドライバーでは、このマニュアルに記載されているすべての SQLSTATEs が返されるとは限りません。このマニュアルに記載されていない SQLSTATEs が返される可能性があります。  
  
-   **複雑さ** 一部のデータベースエンジン (特にリレーショナルデータベースエンジン) は、文字どおり何千ものエラーと警告を返します。 このようなエンジンのドライバーでは、これらのエラーと警告のすべてを SQLSTATEs にマップすることはほとんどありません。これは、必要な作業、マッピングの inexactness、結果として得られるコードの大きなサイズ、および実行時に発生することのないプログラミングエラーを返す可能性があるためです。 そのため、ドライバーは、適切な数のエラーと警告をマップする必要があります。また、SQLSTATE 01004 (データが切り捨てられたデータ) など、アプリケーションロジックの基になるエラーや警告を確実にマップする必要があります。  
  
 SQLSTATEs は確実に返されないため、ほとんどのアプリケーションでは、関連する診断メッセージと共にユーザーに表示されます。これは、多くの場合、発生した特定のエラーや警告、およびネイティブエラーコードに合わせて調整されます。 ほとんどの SQLSTATEs でアプリケーションがロジックをプログラミングすることはできないため、この操作を実行する際に機能が失われることはほとんどありません。 たとえば、 **SQLExecDirect** から SQLSTATE 42000 (構文エラーまたはアクセス違反) が返されるとします。 このエラーの原因となった SQL ステートメントがハードコーディングされているか、アプリケーションによってビルドされている場合は、これがプログラミングエラーとなり、コードを修正する必要があります。 SQL ステートメントがユーザーによって入力された場合、これはユーザーエラーであり、アプリケーションは問題をユーザーに通知することによって可能なすべての処理を実行しています。  
  
 アプリケーションで SQLSTATEs に基本プログラミングロジックを使用する場合は、SQLSTATE が返されないようにするか、別の SQLSTATE を返すように準備する必要があります。 どの SQLSTATEs が確実に返されるかは、多くのドライバーの経験にのみ基づいています。 ただし、一般的なガイドラインとして、データソースではなく、ドライバーまたはドライバーマネージャーで発生したエラーの SQLSTATEs が確実に返される可能性があります。 たとえば、ほとんどのドライバーは SQLSTATE HYC00 (省略可能な機能は実装されていません) を返しますが、より少ないドライバーは SQLSTATE 42021 (列は既に存在します) を返す可能性があります。  
  
 次の SQLSTATEs は、実行時エラーまたは警告を示し、プログラミングロジックの基礎として適しています。 ただし、すべてのドライバーがそれらを返すという保証はありません。  
  
-   01004 (データが切り捨てられました)  
  
-   01S02 (オプション値の変更)  
  
-   HY008 (操作が取り消されました)  
  
-   HYC00 (オプションの機能は実装されていません)  
  
-   HYT00 (タイムアウト期限切れ)  
  
 SQLSTATE HYC00 (実装されていないオプション機能) は、ドライバーが特定のステートメントまたは接続属性をサポートしているかどうかをアプリケーションが判断する唯一の方法であるため、特に重要です。  
  
 SQLSTATEs とそれらを返す関数の完全な一覧については、「 [付録 a: ODBC エラーコード](../../../odbc/reference/appendixes/appendix-a-odbc-error-codes.md)」を参照してください。 各関数が特定の SQLSTATE を返す可能性のある条件の詳細については、その関数を参照してください。
