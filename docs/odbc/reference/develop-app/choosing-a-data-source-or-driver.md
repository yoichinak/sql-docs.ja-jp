---
description: データ ソースまたはドライバーの選択
title: データソースまたはドライバーを選択する |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- connecting to driver [ODBC], selecting driver
- connecting to data source [ODBC], selecting data source
- data sources [ODBC], selecting
- ODBC drivers [ODBC], selecting
ms.assetid: 10aaf570-01ab-4478-8339-bdde2a5e3dd1
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 215e249fe354396239118394d4e792ced67bc82d
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/17/2020
ms.locfileid: "88461604"
---
# <a name="choosing-a-data-source-or-driver"></a>データ ソースまたはドライバーの選択
アプリケーションで使用されるデータソースまたはドライバーは、アプリケーションでハードコーディングされることがあります。 たとえば、MIS 部門によって作成されたカスタムアプリケーションは、データソース間でデータを転送するために、これらのデータソースの名前を格納します。アプリケーションは、他のデータソースでは機能しません。 もう1つの例としては、注文の入力に使用されるアプリケーションなど、垂直方向のアプリケーションがあります。 このようなアプリケーションでは、常に同じデータソースを使用します。このデータソースには、アプリケーションによって認識される定義済みのスキーマがあります。  
  
 他のアプリケーションは、実行時にデータソースまたはドライバーを選択します。 通常、これらは、ODBC を使用してデータをインポートするスプレッドシートなど、アドホッククエリを実行する汎用アプリケーションです。 通常、このようなアプリケーションでは、使用可能なデータソースまたはドライバーが一覧表示され、ユーザーは操作するデータソースを選択できます。 汎用アプリケーションのデータソース、ドライバー、またはその両方が頻繁に一覧表示されるかどうかは、アプリケーションが DBMS ベースまたはファイルベースのドライバーを使用するかどうかによって異なります。  
  
 通常、DBMS ベースのドライバーには、ネットワークアドレス、ネットワークプロトコル、データベース名など、複雑な接続情報のセットが必要です。 データソースの目的は、この情報をすべて非表示にすることです。 そのため、データソースパラダイムは DBMS ベースのドライバーで使用できます。 アプリケーションでは、次の2つの方法のいずれかで、データソースの一覧をユーザーに表示できます。 **DSN** (データソース名) キーワードを使用して**SQLDriverConnect**を呼び出すことができ、関連する値はありません。ドライバーマネージャーには、データソース名の一覧が表示されます。 アプリケーションでリストの外観を制御する必要がある場合は、 **sqldatasources** を呼び出して、使用可能なデータソースの一覧を取得し、独自のダイアログボックスを構築します。 この関数は、ドライバーマネージャーによって実装され、ドライバーが読み込まれる前に呼び出すことができます。 次に、アプリケーションは接続関数を呼び出し、選択したデータソースの名前を渡します。  
  
 データソースが指定されていない場合は、システム情報によって示される既定のデータソースが使用されます。 (詳細については、「 [Default サブキー](../../../odbc/reference/install/default-subkey.md)」を参照してください)。 **SQLConnect** が、見つからない *ServerName* 引数を使用して呼び出された場合、が null ポインターである場合、または "DEFAULT" である場合、ドライバーマネージャーは既定のデータソースに接続します。 既定のデータソースは、 **SQLDriverConnect** または **SQLBrowseConnect** の呼び出しで使用される接続文字列に、 **DSN** キーワードが "default" に設定されている場合、または指定されたデータソースが見つからない場合にも使用されます。 また、 **SQLDriverConnect** の呼び出しで使用される接続文字列に **DSN** キーワードが含まれていない場合は、既定のデータソースが使用されます。  
  
 ファイルベースのドライバーでは、ファイルパラダイムを使用することができます。 ローカルコンピューターに格納されているデータの場合、ユーザーは、そのデータが特定のファイル (たとえば、従業員の .dbf) にあることをよく認識します。 不明なデータソースを選択するのではなく、ユーザーが認識しているファイルを選択する方が簡単です。 これを実装するために、アプリケーションは最初に **Sqldrivers**を呼び出します。 この関数は、ドライバーマネージャーによって実装され、ドライバーが読み込まれる前に呼び出すことができます。 **Sqldrivers** は使用可能なドライバーの一覧を返します。 **Fileusage** キーワードと **fileextns** キーワードの値も返されます。 **Fileusage**キーワードは、ファイルベースのドライバーがファイルをテーブルとして扱うかどうかを説明します。これは、Microsoft®アクセスと同様に、Xbase またはデータベースとして処理されます。 **Fileextns**キーワードは、ドライバーが認識するファイル名拡張子を一覧表示します。たとえば、Xbase ドライバーの場合は .dbf です。 この情報を使用して、アプリケーションはユーザーがファイルを選択するためのダイアログボックスを構築します。 アプリケーションは、選択したファイルの拡張子に基づいて、driver キーワードで **SQLDriverConnect** を呼び出すことによっ **てドライバーに** 接続します。  
  
 アプリケーションでファイルベースのドライバーを使用したデータソースの使用を停止したり、DBMS ベースのドライバーに接続するために**driver**キーワードを使用して**SQLDriverConnect**を呼び出したりすることはできません。 次に、DBMS ベースのドライバーに対する **DRIVER** キーワードの一般的な使用方法をいくつか示します。  
  
-   **データソースを作成していません。** たとえば、カスタムアプリケーションでは、特定のドライバーとデータベースを使用する場合があります。 アプリケーションで、ドライバー名とデータベースへの接続に必要なすべての情報がハードコーディングされている場合、ユーザーはアプリケーションを実行するためにデータソースをコンピューターに作成する必要はありません。 必要なのは、アプリケーションとドライバーをインストールすることだけです。  
  
     この方法の欠点は、接続情報が変更された場合に、アプリケーションを再コンパイルして再配布する必要があることです。 データソース名が完全な接続情報ではなくアプリケーションにハードコーディングされている場合、各ユーザーはデータソース内の情報のみを変更する必要があります。  
  
-   **特定の DBMS に1回アクセスする。** たとえば、ODBC 関数を呼び出してデータを取得するスプレッドシートには、特定のドライバーを識別するための **driver** キーワードが含まれる場合があります。 ドライバー名は、そのドライバーを使用しているユーザーにとって意味があるため、スプレッドシートはそれらのユーザー間で渡される可能性があります。 スプレッドシートにデータソース名が含まれている場合、各ユーザーはスプレッドシートを使用するために同じデータソースを作成する必要があります。  
  
-   **特定のドライバーからアクセスできるすべてのデータベースのシステムを参照しています。** 詳細については、このセクションの後の「 [SQLBrowseConnect を使用した接続](../../../odbc/reference/develop-app/connecting-with-sqlbrowseconnect.md)」を参照してください。
