---
description: 使用するデータベース機能の検討
title: 使用するデータベース機能を検討する |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- interoperability [ODBC], database features
ms.assetid: 59760114-508e-46c5-81d2-8f2498c0d778
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 2abaed3806514a161c5c506d8bad89b4d3b75153
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/17/2020
ms.locfileid: "88465894"
---
# <a name="considering-database-features-to-use"></a>使用するデータベース機能の検討
基本的なレベルの相互運用性が判明したら、アプリケーションで使用されるデータベース機能を考慮する必要があります。 たとえば、アプリケーションはどのような SQL ステートメントを実行しますか。 アプリケーションはスクロール可能なカーソルを使用しますか。 トランザクション? プロシージャ? 長いデータ? すべての Dbms でサポートされていない機能の詳細については、「 [SQLGetInfo](../../../odbc/reference/syntax/sqlgetinfo-function.md)、 [SQLSetConnectAttr](../../../odbc/reference/syntax/sqlsetconnectattr-function.md)、および [SQLSetStmtAttr](../../../odbc/reference/syntax/sqlsetstmtattr-function.md) 関数の説明」と「 [付録 C: SQL 文法](../../../odbc/reference/appendixes/appendix-c-sql-grammar.md)」を参照してください。 アプリケーションが必要とする機能によって、ターゲット Dbms の一覧から一部の Dbms が削除される場合があります。 また、アプリケーションが多くの Dbms を簡単にターゲットにできることを示している場合もあります。  
  
 たとえば、必要な機能が単純な場合、通常は高レベルの相互運用性で実装できます。 単純な **SELECT** ステートメントを実行し、順方向専用カーソルを使用して結果を取得するアプリケーションは、単純化によって相互運用性が高くなる可能性があります。ほとんどのドライバーと dbms は、必要な機能をサポートしています。  
  
 ただし、スクロール可能なカーソル、位置指定の update、delete ステートメント、プロシージャなど、必要な機能がより複雑な場合は、トレードオフを頻繁に行う必要があります。 いくつかの可能性があります。  
  
-   **相互運用性が低く、機能も多くなります。** このアプリケーションには機能が含まれていますが、これらの機能をサポートする Dbms でのみ動作します。  
  
-   **相互運用性が向上し、機能が減少します。** アプリケーションは機能を削除しますが、多くの Dbms で動作します。  
  
-   **高い相互運用性、オプション機能。** このアプリケーションには機能が含まれていますが、これらの機能をサポートする Dbms でのみ使用できます。  
  
-   **相互運用性の向上と機能の強化。** アプリケーションは、これらの機能をサポートする Dbms で機能を使用し、そうでない Dbms に対してそれらをエミュレートします。  
  
 これらの機能はサポートされているすべての Dbms で使用されるか、none として使用されるため、最初の2つのケースは比較的簡単に実装できます。 一方、後者の2つのケースはより複雑です。 どちらの場合も、DBMS が機能をサポートしているかどうかを確認し、最後のケースでは、これらの機能をエミュレートするために大量のコードを記述する必要があります。 そのため、これらのスキームは、より多くの開発時間を必要とし、実行時に速度が低下する可能性があります。  
  
 単一のデータソースに接続できる汎用クエリアプリケーションを考えてみましょう。 アプリケーションは、ユーザーからのクエリを受け入れ、結果をウィンドウに表示します。 ここで、このアプリケーションには、ユーザーが複数のクエリの結果を同時に表示できる機能が1つあるとします。 つまり、クエリを実行して結果の一部を確認し、別のクエリを実行してその結果を確認してから、最初のクエリに戻ることができます。 一部のドライバーでは1つのアクティブなステートメントのみがサポートされるため、相互運用性の問題が発生します。  
  
 アプリケーションには、 **SQLGetInfo**の SQL_MAX_CONCURRENT_ACTIVITIES オプションでドライバーが返す内容に基づいて、いくつかの選択肢があります。  
  
-   **常に複数のクエリをサポートします。** ドライバーに接続した後、アプリケーションはアクティブステートメントの数を確認します。 ドライバーが1つのアクティブステートメントのみをサポートしている場合、アプリケーションは接続を閉じ、ドライバーが必要な機能をサポートしていないことをユーザーに通知します。 アプリケーションは簡単に実装でき、すべての機能を備えていますが、相互運用性は低くなっています。  
  
-   **複数のクエリはサポートされません。** この機能は、アプリケーションによって完全に削除されます。 実装が簡単で、高い相互運用性がありますが、機能が少なくなっています。  
  
-   **ドライバーがの場合にのみ、複数のクエリをサポートします。** ドライバーに接続した後、アプリケーションはアクティブステートメントの数を確認します。 アプリケーションでは、ドライバーが複数のアクティブなステートメントをサポートしている場合にのみ、新しいステートメントが既にアクティブになっている場合に、そのステートメントを開始できます。 アプリケーションの機能と相互運用性は向上していますが、実装するのは困難です。  
  
-   **常に複数のクエリをサポートし、必要に応じてエミュレートします。** ドライバーに接続した後、アプリケーションはアクティブステートメントの数を確認します。 アプリケーションでは、ユーザーが既にアクティブになっている場合に新しいステートメントを開始することを常に許可します。 ドライバーが1つのアクティブステートメントのみをサポートする場合、アプリケーションはそのドライバーへの追加の接続を開き、その接続で新しいステートメントを実行します。 アプリケーションには完全な機能と高い相互運用性がありますが、実装するのは困難です。
