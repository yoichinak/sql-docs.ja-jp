---
description: SQL ステートメントの処理
title: SQL ステートメントの処理 |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- sending SQL statements to DBMS [ODBC]
- SQL statements [ODBC], processing
- SQL [ODBC], processing statements
- statement processing [ODBC]
- SQL statements [ODBC]
- ODBC [ODBC], SQL
ms.assetid: 96270c4f-2efd-4dc1-a985-ed7fd5658db2
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: b4ce614f6dcf4c1fe0ab1e1c806b966b4267e7fe
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/17/2020
ms.locfileid: "88476219"
---
# <a name="processing-a-sql-statement"></a>SQL ステートメントの処理
プログラムによって SQL を使用する方法について説明する前に、SQL ステートメントの処理方法について説明する必要があります。 ここで説明する手順は、3つの方法すべてに共通するものですが、それぞれの方法で異なるタイミングで実行されます。 次の図は、SQL ステートメントの処理に必要な手順を示しています。これについては、このセクションの残りの部分で説明します。  
  
 ![SQL ステートメントの処理手順](../../odbc/reference/media/pr01.gif "pr01")  
  
 SQL ステートメントを処理するために、DBMS は次の5つの手順を実行します。  
  
1.  DBMS はまず SQL ステートメントを解析します。 このステートメントは、トークンと呼ばれる個々の単語に分割され、ステートメントに有効な動詞と有効な句が含まれていることを確認します。 この手順では、構文エラーとスペルミスを検出できます。  
  
2.  DBMS によってステートメントが検証されます。 システムカタログに対してステートメントを確認します。 ステートメントで指定されているすべてのテーブルがデータベースに存在するかどうか。 すべての列が存在し、列名が明確であるかどうか。 ユーザーは、ステートメントを実行するために必要な特権を持っていますか。 この手順では、特定のセマンティックエラーを検出できます。  
  
3.  DBMS は、ステートメントのアクセスプランを生成します。 アクセスプランは、ステートメントを実行するために必要な手順のバイナリ表現です。これは、実行可能コードに相当する DBMS です。  
  
4.  DBMS によってアクセスプランが最適化されます。 このトピックでは、アクセスプランを実行するさまざまな方法について説明します。 インデックスを使用して検索を高速化できますか。 DBMS が最初に検索条件をテーブル A に適用してからテーブル B に結合する必要がありますか。それとも、後で検索条件を使用する必要がありますか。 テーブルのシーケンシャル検索は、テーブルのサブセットに対して回避または縮小することができますか。 代替手段を検討すると、DBMS はそのいずれかを選択します。  
  
5.  DBMS は、アクセスプランを実行してステートメントを実行します。  
  
 SQL ステートメントの処理に使用される手順は、必要なデータベースアクセスの量と所要時間によって異なります。 SQL ステートメントを解析する場合、データベースへのアクセスは必要ありません。非常に短時間で実行できます。 一方、最適化は非常に CPU を集中的に使用するプロセスであり、システムカタログへのアクセスが必要です。 複雑なマルチテーブルクエリでは、オプティマイザーによって、同じクエリを実行するためのさまざまな方法を調べることができます。 ただし、クエリを効率的に実行するためのコストは、通常、最適化に費やされる時間が、クエリの実行速度を向上させることよりも高くなります。 これは、同じ最適化されたアクセスプランを繰り返し使用して繰り返しクエリを実行できる場合に、さらに重要になります。
