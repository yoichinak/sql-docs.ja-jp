---
title: SSMS での可用性グループ ダッシュボードの使用
description: SQL Server Management Studio (SSMS) で Always On 可用性グループ ダッシュボードを使用して、可用性グループの正常性を監視する方法について説明します。
ms.custom: seo-lt-2019
ms.date: 08/09/2018
ms.prod: sql
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
f1_keywords:
- sql13.swb.agdashboard.f1
helpviewer_keywords:
- Availability Groups [SQL Server], policies
- Availability Groups [SQL Server], dashboard
ms.assetid: c9ba2589-139e-42bc-99e1-94546717c64d
author: cawrites
ms.author: chadam
ms.openlocfilehash: 80b7f3e83af181676f09a6dc38b3652ae6142c89
ms.sourcegitcommit: 54cd97a33f417432aa26b948b3fc4b71a5e9162b
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/13/2020
ms.locfileid: "94583664"
---
# <a name="use-the-always-on-availability-group-dashboard-sql-server-management-studio"></a>Always On 可用性グループ ダッシュボードの使用 (SQL Server Management Studio)
[!INCLUDE [SQL Server](../../../includes/applies-to-version/sqlserver.md)]

  データベース管理者は Always On 可用性グループ ダッシュボードを使用して、[!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] の可用性グループとその可用性レプリカおよび可用性データベースの正常性をひとめで確認できるビューを取得します。 可用性グループ ダッシュボードの一般的な用途をいくつか以下に示します。  
  
-   手動フェールオーバー用のレプリカの選択。    
-   フェールオーバーを強制した場合のデータ損失の推定。  
-   データ同期のパフォーマンスの評価。   
-   同期コミット セカンダリ レプリカのパフォーマンスへの影響の評価。 
  -  ダッシュボードは、可用性グループの主要な状態およびパフォーマンス インジケーターを提供し、以下の種類の情報を使用して高可用性操作について容易に判断できるようにします。  
-   レプリカのロールアップの状態    
-   同期のモードと状態   
-   推定データ損失    
-   推定復旧時間 (再実行による遅延の解消)    
-   データベース レプリカの詳細    
-   同期のモードと状態    
-   ログの復元時間  
  
  
## <a name="prerequisites"></a>前提条件  
 可能性グループのプライマリ レプリカまたはセカンダリ レプリカのどちらかをホストする [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] のインスタンス (サーバー インスタンス) に接続されている必要があります。  
  
 
### <a name="permissions"></a>アクセス許可  
 CONNECT、VIEW SERVER STATE、および VIEW ANY DEFINITION 権限が必要です。  
  
##  <a name="to-start-the-always-on-dashboard"></a>Always On ダッシュボードを起動するには  
  
1.  オブジェクト エクスプローラーで、Always On ダッシュボードを実行する [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] のインスタンスに接続します。  
  
2.  **[Always On 高可用性]** ノードを展開し、 **[可用性グループ]** ノードを右クリックして、 **[ダッシュボードの表示]** をクリックします。  
  
##  <a name="change-always-on-dashboard-options"></a>Always On ダッシュボードのオプションを変更する  
 [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] の **[オプション]** ダイアログ ボックスを使って、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Always On ダッシュボードの自動更新と自動定義 Always On ポリシーの有効化の動作を構成できます。  
  
1.  **[ツール]** メニューの **[オプション]** をクリックします。  
  
2.  ダッシュボードを自動的に更新するには、 **[オプション]** ダイアログ ボックスで **[自動更新を有効にする]** を選択し、更新間隔を秒単位で入力して、接続の再試行の回数を入力します。  
  
3.  ユーザー定義ポリシーを有効にするには、 **[ユーザー定義の Always On ポリシーを有効にする]** を選択します。  
  
##  <a name="availability-group-summary"></a>可用性グループの概要  
 可用性グループの画面には、接続されているサーバー インスタンスがホストしているレプリカの可用性グループごとに概要を示す行が表示されます。 このペインには、次の列が表示されます。  
  
 **可用性グループ名**  
 接続されているサーバー インスタンスがホストしているレプリカの可用性グループの名前。  
  
 **[プライマリ インスタンス]**  
 可用性グループのプライマリ レプリカをホストしているサーバー インスタンスの名前。  
  
 **フェールオーバー モード**  
 レプリカの構成で指定されているフェールオーバー モードを表示します。 フェールオーバー モードとして有効な値は、次のとおりです。  
  
-   **[自動]** 。 1 つまたは複数のレプリカが自動フェールオーバー モードであることを示します。  
  
-   **[手動]** 。 自動フェールオーバー モードのレプリカがないことを示します。  
  
 **問題**  
 **[問題]** リンクをクリックすると、問題のトラブルシューティングのドキュメントが表示されます。 Always On ポリシーのすべての問題の一覧は、「[Always On 可用性グループでの運用上の問題のポリシー ベースの管理 &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/always-on-policies-for-operational-issues-always-on-availability.md)」を参照してください。  
  
> [!TIP]  
>  列見出しをクリックすると、可用性グループの名前、プライマリ インスタンス、フェールオーバー モード、または問題で、可用性グループの情報を並べ替えることができます。  
  
##  <a name="availability-group-details"></a><a name="AvGroupDetails"></a> 可用性グループの詳細  
 概要の画面で選択した可用性グループについての以下の詳細情報が表示されます。  
  
 **[可用性グループの状態]**  
 可用性グループの正常性の状態を表示します。  
  
 **Primary instance**  
 可用性グループのプライマリ レプリカをホストしているサーバー インスタンスの名前。  
  
 **Failover mode**  
 レプリカの構成で指定されているフェールオーバー モードを表示します。 フェールオーバー モードとして有効な値は、次のとおりです。  
  
-   **[自動]** 。 1 つまたは複数のレプリカが自動フェールオーバー モードであることを示します。  
  
-   **[手動]** 。 自動フェールオーバー モードのレプリカがないことを示します。  
  
 **[クラスターの状態]**  
 接続されているサーバーのインスタンスと可用性グループがメンバー ノードになっているクラスターの名前と状態。  
  
##  <a name="availability-replica-details"></a><a name="AvReplicaDetails"></a> 可用性レプリカの詳細  

プライマリ レプリカに接続されていると、 **[Availability replica details]\(可用性レプリカの詳細\)** には可用性グループないのすべてのレプリカからの情報が表示されます。 セカンダリ レプリカに接続されいる場合は、接続されたレプリカからの情報のみが表示されます。  

**[可用性レプリカ]** ペインには、次の列が表示されます。  
  
 **Name**  
 可用性レプリカをホストするサーバー インスタンスの名前。 この列は既定で表示されます。  
  
 **ロール**  
 可用性レプリカの現在のロール ( **[プライマリ]** または **[セカンダリ]** ) を示します。 [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] のロールについては、「[Always On 可用性グループの概要 &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/overview-of-always-on-availability-groups-sql-server.md)」を参照してください。 この列は既定で表示されます。  
  
 **フェールオーバー モード**  
 レプリカの構成で指定されているフェールオーバー モードを表示します。 フェールオーバー モードとして有効な値は、次のとおりです。  
  
-   **[自動]** 。 1 つまたは複数のレプリカが自動フェールオーバー モードであることを示します。  
  
-   **[手動]** 。 自動フェールオーバー モードのレプリカがないことを示します。  
  
 **[同期状態]**  
 セカンダリ レプリカが現在プライマリ レプリカと同期されているかどうかを示します。 この列は既定で表示されます。 指定できる値は、  
  
-   **[同期未実行]** 。 レプリカ内の 1 つ以上のデータベースが同期されておらず、可用性グループにまだ参加していません。  
  
-   **[同期中]** 。 レプリカ内の 1 つ以上のデータベースは同期されています。  
  
-   **[同期済み]** 。 セカンダリ レプリカ内のすべてのデータベースは、現在のプライマリ レプリカ (ある場合) または最後のプライマリ レプリカ上の対応するプライマリ データベースと同期されています。  
  
    > [!NOTE]  
    >  パフォーマンス モードでは、データベースは同期済みの状態にはなりません。  
  
-   **NULL**。 不明な状態です。 この値は、ローカル サーバー インスタンスが WSFC フェールオーバー クラスターと通信できない (ローカル ノードが WSFC クォーラムの一部ではない) 場合に生じます。  
  
 **問題**  
 問題の名前が一覧表示されます。 この値は既定で表示されます。 Always On ポリシーのすべての問題の一覧は、「[Always On 可用性グループでの運用上の問題のポリシー ベースの管理 &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/always-on-policies-for-operational-issues-always-on-availability.md)」を参照してください。  
  
 **可用性モード**  
 各可用性レプリカのために個別に設定したレプリカ プロパティを示します。 この値は既定で非表示になります。 指定できる値は、  
  
-   **[非同期]** 。 セカンダリ レプリカがプライマリ レプリカと同期されることはありません。  
  
-   **Synchronous**。 セカンダリ データベースは、プライマリ データベースからの遅れを取り戻すと、この状態になります。データベースでデータの同期が継続されている間は、この状態が続きます。  
  
 **プライマリ接続モード**  
 プライマリ レプリカへの接続に使用されるモードを示します。  この値は既定で非表示になります。  
  
 **セカンダリ接続モード**  
 セカンダリ レプリカへの接続に使用されるモードを示します。  この値は既定で非表示になります。  
  
 **接続状態**  
 セカンダリ レプリカが現在プライマリ レプリカに接続されているかどうかを示します。 この列は既定で非表示になります。 指定できる値は、  
  
-   **[接続解除]** 。 リモート可用性レプリカの場合、ローカル可用性レプリカから切断されていることを示します。 接続解除状態のローカル レプリカの応答は、そのロールによって次のように異なります。  
  
    -   プライマリ レプリカでは、セカンダリ レプリカが切断されている場合、プライマリ レプリカ上のセカンダリ データベースは **[同期未実行]** とマークされ、プライマリ レプリカはセカンダリが再接続するのを待機します。  
  
    -   セカンダリ レプリカでは、切断されていることを検出すると、セカンダリ レプリカはプライマリ レプリカへの再接続を試みます。  
  
-   **Connected**. 現在ローカル レプリカに接続されているリモート可用性レプリカです。  
  
 **動作状態**  
 セカンダリ レプリカの現在の操作状態を示します。 この値は既定で非表示になります。 指定できる値は、  
  
 **0**.フェールオーバー保留    
 **1**.Pending    
 **2**.オンライン    
 **3**.Offline   
 **4**.失敗    
 **5**.失敗、クォーラムなし  
  
 **NULL**。 レプリカがローカルでない  
  
 **[最後の接続エラー番号]**  
 最後の接続エラーの番号。  この値は既定で非表示になります。  
  
 **[最後の接続エラーの説明]**  
 最後の接続エラーの説明。  この値は既定で非表示になります。  
  
 **[最後の接続エラーのタイムスタンプ]**  
 最後の接続エラーのタイムスタンプ。 この値は既定で非表示になります。  
  
> [!NOTE]  
>  可用性レプリカのパフォーマンス カウンターの詳細については、「 [SQL Server、Availability Replica](../../../relational-databases/performance-monitor/sql-server-availability-replica.md)」を参照してください。  
  
##  <a name="group-by-availability-group-information"></a>可用性グループの情報をグループ化する  
 情報をグループ化するには、 **[グループ化]** をクリックし、次のいずれかを選択します。  
  
-   **可用性レプリカ**    
-   **可用性データベース** 
-   **Synchronization state**  
-   **フェールオーバーの準備**   
-   **問題**  
  
 グループ化された情報を表示するペインには、次の列が表示されます。  
  
 **Name**  
 可用性データベースの名前です。 この値は既定で表示されます。  
  
 **[レプリカ]**  
 可用性レプリカをホストする [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] のインスタンスの名前。 この値は既定で表示されます。  
  
 **[同期状態]**  
 可用性データベースが現在プライマリ レプリカと同期されているかどうかを示します。 この値は既定で表示されます。 有効な同期状態は次のとおりです。  
  
-   **[同期されていません]** :  
-   
    -   プライマリ ロールの場合、データベースがそのトランザクション ログを対応するセカンダリ データベースと同期する準備ができていないことを示します。   
    -   セカンダリ データベースの場合、データベースが接続の問題によりログの同期を開始していないか、データベースが中断されているか、起動中またはロールの切り替え中にデータベースが遷移状態になっていることを示します。  
  
-   **[同期中]** :
- プライマリ レプリカの場合:   
    - プライマリ データベースでは、このデータベースがセカンダリ データベースからのスキャン要求を受け入れる準備ができていることを示します。  
    - セカンダリ データベースについては、そのセカンダリ データベースのアクティブなデータ移動が行われていることを示します。 
  
  
-   **[同期済み]** : 
  
    - プライマリ データベースの場合、少なくとも 1 つのセカンダリ データベースが同期されていることを示します。
    - セカンダリ データベースの場合、対応するプライマリ データベースと同期されていることを示します。  
  
-   **[元に戻しています]** 。  
  
     セカンダリ データベースがプライマリ データベースからページをアクティブに取得している場合の元に戻すプロセスのフェーズを示します。  
  
    > [!CAUTION]  
    >  データベースが REVERTING 状態の場合、セカンダリ レプリカに強制的にフェールオーバーすると、そのデータベースは起動できない状態のままになる可能性があります。  
  
-   **[初期化中]** 。  
  
     セカンダリ データベースが元に戻す LSN からの遅れを取り戻すために必要なトランザクション ログがセカンダリ レプリカに配布され、書き込まれている場合の元に戻すフェーズを示します。  
  
    > [!CAUTION]  
    >  データベースが INITIALIZING 状態の場合、セカンダリ レプリカに強制的にフェールオーバーすると、常にそのデータベースは起動できない状態のままになります。  
  
 **[フェールオーバーの準備]**  
 どの可用性レプリカがフェールオーバーできるかを、データ損失の可能性の有無と共に示します。 この列は既定で表示されます。 指定できる値は、  
  
-   **[データ損失]**   
-   **[データ損失なし]**  
  
 **問題**  
 問題の名前が一覧表示されます。 この列は既定で表示されます。 指定できる値は、  
  
-   **[警告]** 。 クリックすると、しきい値と警告の問題が表示されます。   
-   **[重大]** 。 クリックすると、重大な問題が表示されます。  
  
 Always On ポリシーのすべての問題の一覧は、「[Always On 可用性グループでの運用上の問題のポリシー ベースの管理 &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/always-on-policies-for-operational-issues-always-on-availability.md)」を参照してください。  
  
 **中断済み**  
 データベースが **[中断状態]** であるか **[再開]** されたかを示します。 この値は既定で非表示になります。  
  
 **中断の理由**  
 中断状態の理由を示します。 この値は既定で非表示になります。  
  
 **[推定データ損失] (秒)**  
 プライマリ レプリカおよびセカンダリ レプリカ内の最後のトランザクション ログ レポートの時間の差分を示します。 プライマリ レプリカが失敗すると、時間枠内のすべてのトランザクション ログ レコードが失われます。 この値は既定で非表示になります。  
  
 **[推定復旧時間] (秒)**  
 キャッチアップ時間の再実行にかかる時間を秒単位で示します。 *キャッチアップ時間* は、セカンダリ レプリカがプライマリ レプリカに追いつくためにかかる時間です。 この値は既定で非表示になります。  
  
 **[同期のパフォーマンス] (秒)**  
 プライマリ レプリカとセカンダリ レプリカ間の同期にかかる時間を秒単位で示します。 この値は既定で非表示になります。  
  
 **[ログ送信キューのサイズ] (KB)**  
 まだセカンダリ レプリカに送信されていない、プライマリ データベースのログ ファイル内のログ レコードの数を示します。 この値は既定で非表示になります。  
  
 **[ログの送信速度 (KB/秒)]**  
 ログ レコードがセカンダリ レプリカに送信される比率を 1 秒あたりの KB 単位で示します。 この値は既定で非表示になります。  
  
 **[再実行キューのサイズ] (KB)**  
 まだ再実行されていない、セカンダリ レプリカのログ ファイル内のログ レコードの数を示します。 この値は既定で非表示になります。  
  
 **[再実行率 (KB/秒)]**  
 ログ レコードが再実行される速度を 1 秒あたりの KB 単位で示します。 この値は既定で非表示になります。  
  
 **[FileStream 送信比率] (KB/秒)**  
 トランザクションがレプリカに送信されるときの FileStream の比率を 1 秒あたりの KB 単位で示します。 この値は既定で非表示になります。  
  
 **[ログ LSN の最後]**  
 プライマリ レプリカおよびセカンダリ レプリカのログ キャッシュ内の最後のログ レコードに対応する実際のログ シーケンス番号 (LSN) を示します。 この値は既定で非表示になります。  
  
 **[復旧 LSN]**  
 プライマリ レプリカでの復旧後またはフェールオーバー後、レプリカが新しいログ レコードを書き込む前のトランザクション ログの末尾を示します。 この値は既定で非表示になります。  
  
 **[切り捨て LSN]**  
 プライマリ レプリカの最小のログ切り捨て値を示します。 この値は既定で非表示になります。  
  
 **[最後にコミットした LSN]**  
 トランザクション ログの最終コミット レコードに対応する実際の LSN を示します。 この値は既定で非表示になります。  
  
 **[最終コミット時間]**  
 最終コミット レコードに対応する時刻を示します。 この値は既定で非表示になります。  
  
 **[最後に送信した LSN]**  
 プライマリ レプリカによって送信されたすべてのログ ブロックの最後のポイントを示します。 この値は既定で非表示になります。  
  
 **[最終送信時間]**  
 ログ ブロックが最後に送信された時刻を示します。 この値は既定で非表示になります。  
  
 **[最後に受信した LSN]**  
 セカンダリ データベースをホストするセカンダリ レプリカによって受信されたすべてのログ ブロックの最後のポイントを示します。 この値は既定で非表示になります。  
  
 **[最終受信時間]**  
 最後に受信されたメッセージのログ ブロック識別子がセカンダリ レプリカで読み取られた時刻を示します。 この値は既定で非表示になります。  
  
 **[最後に書き込まれた LSN]**  
 セカンダリ レプリカのディスクにフラッシュされたすべてのログ レコードの最後のポイントを示します。 この値は既定で非表示になります。  
  
 **[最終書き込み時刻]**  
 セカンダリ レプリカで最後に書き込まれた LSN のためにログ ブロック ID が受信された時刻を示します。 この値は既定で非表示になります。  
  
 **[最後に再実行された LSN]**  
 セカンダリ レプリカで最後に再実行されたログ レコードの実際の LSN を示します。 この値は既定で非表示になります。  
  
 **[最終再実行時間]**  
 セカンダリ データベースでログ レコードが最後に再実行された時刻を示します。 この値は既定で非表示になります。  
 

   > [!NOTE]  
   >  ほとんどのデータは sys.dm_hadr_database_replica_states に基づいているため、いくつかの制限が適用される場合があります。 詳細については、「[sys.dm_hadr_database_replica_states (Transact-SQL)](../../../relational-databases/system-dynamic-management-views/sys-dm-hadr-database-replica-states-transact-sql.md)」を参照してください。


## <a name="always-on-availability-group-latency-reports"></a>Always On 可用性グループ待機時間レポート
可用性グループ待機時間レポートは、可用性グループ ダッシュボードに組み込まれているレポート ツールであり、[SQL Server Management Studio 17.4](../../../ssms/download-sql-server-management-studio-ssms.md) リリースで使用できます。 この機能では、ログ転送プロセスのさまざまなフェーズで費やされる時間を詳細に示すわかりやすいレポートが提供されます。 これにより、同期プロセス中の待機時間の潜在的な原因を絞り込むことができます。 

SQL エージェントではデータ収集を行います。プライマリ レプリカと、1 つ以上のセカンダリ レプリカの両方で SQL エージェントを有効にする必要があります。 SQL Server Management Studio の **オブジェクト エクスプローラー** で、可用性グループを右クリックし、[レポート]、[標準レポート] の順に選択してレポートを表示します。  

詳細については、[Always On 可用性グループの待機時間レポート](/archive/blogs/sql_server_team/new-in-ssms-always-on-availability-group-latency-reports)に関するページを参照してください。

## <a name="related-tasks"></a>Related Tasks  
  
-   [Always On ポリシーを使用した可用性グループの正常性の確認 &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/use-always-on-policies-to-view-the-health-of-an-availability-group-sql-server.md)  
  
## <a name="see-also"></a>参照  
 [sys.dm_os_performance_counters &#40;Transact-SQL&#41;](../../../relational-databases/system-dynamic-management-views/sys-dm-os-performance-counters-transact-sql.md)   
 [可用性グループの監視 &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/monitoring-of-availability-groups-sql-server.md)  
  
