---
description: Keyset カーソル
title: キーセットカーソル |Microsoft Docs
ms.prod: sql
ms.prod_service: connectivity
ms.technology: ado
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- Keyset cursors [ADO]
- cursors [ADO], Keyset
ms.assetid: 14b51b17-6fd9-4146-af45-ca4b0fe6d48a
author: rothja
ms.author: jroth
ms.openlocfilehash: 8c84bf798dcdb543dd0ae407474aa68cfb06a9ba
ms.sourcegitcommit: 18a98ea6a30d448aa6195e10ea2413be7e837e94
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/27/2020
ms.locfileid: "88980343"
---
# <a name="keyset-cursors"></a>Keyset カーソル
キーセットカーソルは、静的カーソルと動的カーソルの間に、変更を検出する機能を提供します。 静的カーソルと同様に、結果セットのメンバーシップと順序に対する変更は常に検出されません。 動的カーソルと同様に、結果セット内の行の値に対する変更は検出されます。  
  
 キーセット ドリブン カーソルは、キーセットという一意の識別子 (キー) のセットにより制御されます。 これらのキーは、結果セットの行を一意に識別する列のセットから構築されます。 キーセットは、クエリ ステートメントによって返されるすべての行からのキー値のセットです。  
  
 キーセット ドリブン カーソルでは、カーソルの行ごとにキーが作成されて保存され、クライアント ワークステーションまたはサーバーに格納されます。 各行にアクセスすると、格納されているキーを使用して、データ ソースから現在のデータ値がフェッチされます。 キーセット ドリブン カーソルでは、キーセットが完全に作成された時点で、結果セットのメンバーシップは凍結されます。 したがって、メンバーシップに影響を与える追加または更新は、開き直されるまで結果セットには反映されません。  
  
 データ値に対する変更 (キーセット所有者または他のプロセスによって行われる) は、ユーザーが結果セットをスクロールすると表示されます。 (他のプロセスによって) カーソルの外部で行われた挿入は、カーソルを閉じて再度開いた場合にのみ表示されます。 カーソルの内部から行われた挿入は、結果セットの末尾に表示されます。  
  
 キーセットドリブンカーソルが削除された行を取得しようとすると、その行は結果セットに "パンチ穴" として表示されます。 行に対するキーはキーセット内に存在しますが、結果セットには行は存在しなくなっています。 行のキー値が更新された場合、その行は削除されてから挿入されたと見なされます。そのため、このような行も結果セットに穴として表示されます。 キーセットドリブンカーソルは、他のプロセスによって削除された行を常に検出できますが、必要に応じて、削除する行のキーを削除することもできます。 これを行うキーセットドリブンカーソルは、証拠が削除されているため、独自の削除を検出できません。  
  
 キー列の更新は、古いキーを削除した後、新しいキーを挿入するように動作します。 カーソルによって更新が行われなかった場合、新しいキー値は表示されません。 カーソルによって更新が行われた場合、新しいキー値は結果セットの最後に表示されます。  
  
 キーセットドリブンの標準カーソルと呼ばれるキーセットドリブンカーソルには、さまざまなバリエーションがあります。 キーセットドリブン標準カーソルでは、カーソルを開いたときに、結果セット内の行のメンバーシップと行の順序が固定されます。ただし、他のプロセスによって行われた、カーソル所有者とコミットされた変更によって行われた値の変更は表示されます。 変更によって、メンバーシップの行が、されたり、行の順序に影響したりした場合、カーソルを閉じてから再度開くまで、行が非表示になったり、移動したりすることはありません。 挿入されたデータは表示されませんが、既存のデータに対する変更は、行がフェッチされると表示されます。  
  
 データの変更に対する機密度は、前述のようにさまざまな状況によって異なるため、キーセットドリブンカーソルは正しく使用できません。 ただし、アプリケーションが同時更新を考慮しておらず、正しくないキーをプログラムで処理し、特定のキー付き行に直接アクセスする必要がある場合は、キーセットドリブンカーソルが機能する可能性があります。 **Adopenkeyset Cursor Typeenum**を使用して、ADO で keyset カーソルを使用することを指定します。  
  
## <a name="see-also"></a>参照  
 [順方向専用カーソル](./forward-only-cursors.md)   
 [静的カーソル](./static-cursors.md)   
 [動的カーソル](./dynamic-cursors.md)