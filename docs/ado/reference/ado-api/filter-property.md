---
description: Filter プロパティ
title: Filter プロパティ |Microsoft Docs
ms.prod: sql
ms.prod_service: connectivity
ms.technology: ado
ms.custom: ''
ms.date: 03/20/2018
ms.reviewer: ''
ms.topic: conceptual
apitype: COM
f1_keywords:
- Recordset15::Filter
helpviewer_keywords:
- Filter property
ms.assetid: 80263a7a-5d21-45d1-84fc-34b7a9be4c22
author: rothja
ms.author: jroth
ms.openlocfilehash: 2519fdf691cc0f982f16a3aa77fdb66036bd86e8
ms.sourcegitcommit: 18a98ea6a30d448aa6195e10ea2413be7e837e94
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/27/2020
ms.locfileid: "88973003"
---
# <a name="filter-property"></a>Filter プロパティ
[レコードセット](./recordset-object-ado.md)内のデータのフィルターを示します。  
  
## <a name="settings-and-return-values"></a>設定と戻り値

**バリアント**値を設定または返します。この値には、次のいずれかの項目を含めることができます。  
  
-   **条件文字列:****AND**また**は or**演算子と連結された1つ以上の個別の句で構成される文字列。  
  
-   **ブックマークの配列:** レコード **セット** オブジェクトのレコードを指す一意のブックマーク値の配列。  
  
-   [Filtergroupenum](./filtergroupenum.md)値。  
  
## <a name="remarks"></a>解説

**フィルター**プロパティを使用して、レコード**セット**オブジェクトのレコードを選択的に表示します。 フィルター選択された **レコードセット** が現在のカーソルになります。 現在の **カーソル** に基づいて値を返すその他のプロパティは、 [ABSOLUTEPOSITION property (ado)](./absoluteposition-property-ado.md)、 [AbsolutePage property (ado)](./absolutepage-property-ado.md)、 [RecordCount Property (ADO](./recordcount-property-ado.md))、および [PageCount property (ado)](./pagecount-property-ado.md)などの影響を受けます。 **Filter**プロパティを特定の新しい値に設定すると、現在のレコードが、新しい値を満たす最初のレコードに移動します。
  
条件文字列は、 *FieldName-Operator-Value* という形式の句で構成されています (例: `"LastName = 'Smith'"` )。 複合句を作成するには、個別の句を **AND** (たとえば、 `"LastName = 'Smith' AND FirstName = 'John'"` ) また **は or** (など) と連結し `"LastName = 'Smith' OR LastName = 'Jones'"` ます。 条件文字列の場合は、次のガイドラインに従います。

-   *FieldName* は、 **レコードセット**の有効なフィールド名である必要があります。 フィールド名にスペースが含まれている場合は、名前を角かっこで囲む必要があります。  
  
-   演算子は \<, > 、、 \<=, > =、 <>、=、または **LIKE**のいずれかである必要があります。  
  
-   値は、フィールド値の比較に使用する値です (例、' Smith '、#8/24/95 #、12.345、$50.00)。 文字列とシャープ記号 (#) を使用して、単一引用符を使用します。 数値の場合は、小数点、ドル記号、および指数表記を使用できます。 Operator が **LIKE**の場合、値にはワイルドカードを使用できます。 アスタリスク (*) とパーセント記号 (%) のみワイルドカードを使用できます。また、文字列の最後の文字である必要があります。 値を null にすることはできません。  
  
> [!NOTE]
>  フィルター値に単一引用符 (') を含めるには、2つの単一引用符を使用して1つのを表します。 たとえば、O'Malley に対してフィルター処理を行うには、条件文字列をにする必要があり `"col1 = 'O''Malley'"` ます。 フィルター値の先頭と末尾の両方に単一引用符を含めるには、文字列をシャープ記号 (#) で囲みます。 たとえば、' 1 ' でフィルター処理するには、条件文字列をにする必要があり `"col1 = #'1'#"` ます。  
  
-   AND と OR の間には優先順位がありません。 句は、かっこ内でグループ化できます。 ただし、次のコードスニペットのように、OR で結合された句をグループ化してから、とを使用して別の句にグループを結合することはできません。  
 `(LastName = 'Smith' OR LastName = 'Jones') AND FirstName = 'John'`  
  
-   代わりに、次のようにこのフィルターを構築します。  
 `(LastName = 'Smith' AND FirstName = 'John') OR (LastName = 'Jones' AND FirstName = 'John')`  
  
-   **LIKE**句では、パターンの先頭と末尾にワイルドカードを使用できます。 たとえば、`LastName Like '*mit*'` を使用できます。 また、 **LIKE** では、パターンの最後でのみワイルドカードを使用できます。 たとえば、「 `LastName Like 'Smit*'` 」のように入力します。  
  
 フィルター定数を使用すると、バッチ更新モード中に個々のレコードの競合を解決しやすくなります。たとえば、最後の [UpdateBatch メソッド](./updatebatch-method.md) メソッド呼び出しの間に影響を受けたレコードだけを表示できます。  
  
**フィルター**プロパティ自体の設定は、基になるデータとの競合によって失敗する可能性があります。 たとえば、このエラーは、レコードが別のユーザーによって既に削除されている場合に発生する可能性があります。 このような場合、プロバイダーは [エラーコレクション (ADO)](./errors-collection-ado.md) コレクションに警告を返しますが、プログラムの実行を停止することはありません。 実行時のエラーは、要求されたすべてのレコードに競合がある場合にのみ発生します。 競合しているレコードを検索するには、 [Status プロパティ (ADO Recordset)](./status-property-ado-recordset.md) プロパティを使用します。  
  
**Filter**プロパティを長さ0の文字列 ("") に設定すると、 **adfilternone**定数を使用する場合と同じ効果があります。
  
**フィルター**プロパティが設定されている場合、現在のレコードの位置は、レコード**セット**内のフィルター処理されたレコードセット内の最初のレコードに移動します。 同様に、 **フィルター** プロパティをクリアすると、現在のレコード位置がレコード **セット**内の最初のレコードに移動します。

たとえば、sql_variant 型など、バリアント型のフィールドに基づいて **レコードセット** がフィルター処理されるとします。 条件文字列で使用されているフィールドとフィルター値のサブタイプが一致しない場合、エラー (DISP_E_TYPEMISMATCH または 80020005) が発生します。 たとえば、次のように想定します。

- **レコードセット**オブジェクト (rs) には、sql_variant 型の列 (C) が含まれています。
- この列のフィールドには、I4 型の値1が割り当てられています。 条件文字列は、フィールドでに設定され `rs.Filter = "C='A'"` ます。

この構成では、実行時にエラーが生成されます。 ただし、 `rs.Filter = "C=2"` 同じフィールドに適用してもエラーは生成されません。 また、フィールドが現在のレコードセットから除外されます。

[ブックマークの [プロパティ (ADO)](./bookmark-property-ado.md) ] プロパティを参照してください。ブックマークの値によって、Filter プロパティで使用する配列を作成できます。

条件文字列の形式のフィルターのみが、永続化された **レコードセット**の内容に影響します。 条件文字列の例としては、が `OrderDate > '12/31/1999'` あります。 ブックマークの配列を使用して作成されたフィルター、または **Filtergroupenum**の値を使用して作成されたフィルターは、永続化された **レコードセット**の内容には影響しません。 これらのルールは、クライアント側カーソルまたはサーバー側カーソルを使用して作成されたレコードセットに適用されます。
  
> [!NOTE]
>  バッチ更新モードでフィルター処理および変更されたレコード **セット** に adFilterPendingRecords フラグを適用すると、フィルター処理が単一キーテーブルのキーフィールドに基づいており、キーフィールド値に対して変更が行われた場合、結果の **レコードセット** は空になります。 次のいずれかのステートメントが true の場合、結果の **レコードセット** は空になりません。  
  
-   フィルター処理は、単一キーテーブルのキー以外のフィールドに基づいていました。  
  
-   フィルター処理は、複数のキーを持つテーブルのフィールドに基づいていました。  
  
-   1つのキーを持つテーブルのキー以外のフィールドに変更が加えられました。  
  
-   複数のキーを持つテーブルのフィールドに対して変更が行われました。  
  
次の表は、フィルター処理と変更のさまざまな組み合わせにおける **Adfilterpendingrecords** の影響をまとめたものです。 左側の列には、考えられる変更が示されています。 キーを使用しない任意のフィールド、単一キーテーブルのキーフィールド、または複数のキーが設定されたテーブルのいずれかのキーフィールドに対して変更を行うことができます。 一番上の行には、フィルターの条件が表示されます。 フィルター処理は、非キーフィールド、単一キーテーブルのキーフィールド、または複数のキーが設定されたテーブルのいずれかのキーフィールドに基づいて行うことができます。 交差するセルに結果が表示されます。 **+** プラス記号は、 **Adfilterpendingrecords**を適用すると、空ではない**レコードセット**が生成されることを意味します。 **-** 負符号は空の**レコードセット**を意味します。  
  
|組み合わせ|非キー|1つのキー|複数のキー|
|-|--------------|----------------|-------------------|
|**非キー**|+|+|+|
|**1つのキー**|+|-|該当なし|
|**複数のキー**|+|該当なし|+|
|||||
  
## <a name="applies-to"></a>適用対象

[Recordset オブジェクト (ADO)](./recordset-object-ado.md)  
  
## <a name="see-also"></a>参照

[Filter プロパティと RecordCount プロパティの例 (VB)](./filter-and-recordcount-properties-example-vb.md) 
[Filter プロパティと RecordCount プロパティの例 (VC + +)](./filter-and-recordcount-properties-example-vc.md) 
[Clear メソッド (ADO)](./clear-method-ado.md) 
[Optimize プロパティ-動的 (ADO)](./optimize-property-dynamic-ado.md)