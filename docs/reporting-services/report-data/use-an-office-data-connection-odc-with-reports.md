---
title: レポートで Office Data Connection (.odc) を使用する | Microsoft Docs
description: 既存の Office データ接続 (.odc) ファイルを使用して Reporting Services レポートに接続情報を提供する方法について説明します。
ms.date: 03/14/2017
ms.prod: reporting-services
ms.prod_service: reporting-services-native
ms.technology: report-data
ms.topic: conceptual
helpviewer_keywords:
- Office Data Connection (.odc) files
- SharePoint integration [Reporting Services], shared data sources
- .odc files
ms.assetid: e8d6896d-f886-4390-8b5d-96f0a50c250c
author: maggiesMSFT
ms.author: maggies
ms.openlocfilehash: 7403bdc38692d843de266a64e8b44245ee966555
ms.sourcegitcommit: fe59f8dc27fd633f5dfce54519d6f5dcea577f56
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/09/2020
ms.locfileid: "91935160"
---
# <a name="use-an-office-data-connection-odc-with-reports"></a>レポートで Office Data Connection (.odc) を使用する
  限られたシナリオでは、既存の Office データ接続 (.odc) ファイルを使用して、 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] レポートに接続情報を提供できます。 共有データ ソースの作成時には、.rsds ファイルの代わりに .odc ファイルを使用できます。 レポート サーバーでは、.rsds ファイルの場合と同様に .odc ファイルを使用して、データ ソースの種類、接続文字列、および資格情報をファイルから読み取ります。  
  
 すべての .odc ファイルが [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] レポートで使用できるとは限りません。 .odc ファイルを使用できるかどうかは、次に示すデータ処理拡張機能や、レポートおよび .odc ファイルの特性によって決まります。  
  
-   レポートは、OLE DB または ODBC データ プロバイダーと連携できるように設計する必要があります。 他のデータ処理拡張機能を使用してレポートを作成した場合、レポートとそのクエリには OLE DB または ODBC データ プロバイダーでサポートされていない機能が含まれることがあります。  
  
-   .odc ファイルには所定の要素と構造が求められます。 このファイルには、レポート サーバーで読み取ることができるように、データ プロバイダーと資格情報に関する設定を明示的に記述しなければなりません。 これらの値を設定するのに最も適した方法は、.odc ファイルを SharePoint ライブラリにアップロードする前にエクスポートすることです。  
  
-   .odc ファイルには、接続の種類として OLE DB または ODBC を指定しておく必要があります。  
  
-   .odc ファイルには、接続文字列を指定しておく必要があります。  
  
-   資格情報は、 **None**、 **Stored**、または **Integrated**に設定できます。 資格情報の使用方法が **Stored**に設定されている場合、レポート サーバーでは保存されている資格情報を使用せず、ユーザーに資格情報を指定するように求めます。 レポート サーバーでは、.odc ファイルに定義されている保存済みの資格情報を使用することはできません。  
  
-   データ ソースのスキーマは、レポートの作成に使用されたスキーマと同じである必要があります。 データ構造が異なる場合は、レポートが実行されません。  
  
-   .odc ファイルは [!INCLUDE[msCoName](../../includes/msconame-md.md)] Office 2007 で作成する必要があります (これより古いバージョンの .odc ファイルはレポート定義ファイルとの互換性がありません)。  
  
 .odc データ ソースの種類が、サポートされているデータ ソースの種類に似ていても、レポート サーバーで処理できないデータ ソースへの接続が指定された .odc ファイルを使用することはできません。 具体的には、Microsoft Access、Web、またはテキスト ファイルからデータを取得する .odc ファイルを Microsoft Excel 2007 で作成した場合、その .odc ファイルを使用してレポートにデータを提供することはできません。  
  
 レポート ビルダーのレポートとモデルには、.odc ファイルを連携させることができません。 .odc ファイルを使用してモデルを生成することはできません。また、.odc ファイルにリンクする共有データ ソースが使用されるようにモデルを構成することもできません。  
  
 .odc ファイルに関する知識があまりなくても、次の手順を使用して .odc ファイルを作成およびエクスポートすることができます。 OLE DB データ ソース用に .odc ファイルを作成する簡単な方法の 1 つは、Excel 2007 とデータ接続ウィザードを使用することです。 ただし、このウィザードではデータ ソースが作成されないので、定義済みの外部データ ソースを用意しておく必要があります。  
  
 既存の .odc ファイルは、レポートやクエリと完全な互換性がある場合にのみ使用してください。 レポートまたは .odc ファイルに対して大幅な変更が必要になるようなエラーが発生する場合は、レポート用に .rsds ファイルを新しく作成します。 .rsds ファイルを使用する共有データ ソースを作成する方法の詳細については、「[共有データ ソースを作成および管理する (Reporting Services の SharePoint 統合モード)](/previous-versions/sql/)」を参照してください。  
  
### <a name="to-create-and-export-an-odc-file"></a>.odc ファイルを作成してエクスポートするには  
  
1.  Excel 2007 を起動します。  
  
2.  **[データ]** タブで、 **[外部データの取り込み]** グループの **[その他のデータ ソース]** をクリックし、 **[データ接続ウィザード]** をクリックします。  
  
3.  **[その他/詳細]** を選択し、 **[次へ]** をクリックします。  
  
4.  **[Microsoft OLE DB Provider for SQL Server]** を選択し、 **[次へ]** をクリックします。  
  
5.  サーバー名 (既定ではコンピューターのネットワーク名)、および有効なログインとデータベース権限が与えられたユーザー アカウントを入力します。 **[次へ]** をクリックします。  
  
6.  データベースを選択して **[OK]** をクリックし、 **[データ リンク]** ダイアログ ボックスを閉じます。  
  
7.  **[指定したテーブルに接続]** チェック ボックスは既定でオンになっています。 このオプションは、特定のテーブルからデータを取得する場合に使用します。 レポート サーバーでは .odc ファイル内のすべてのクエリが無視されるので、このチェック ボックスはオンとオフのどちらになっていてもかまいません。 レポートのデータを取得するクエリは、外部ファイルではなくレポート定義ファイルに含まれています。  
  
8.  接続が開いている間は、プロパティを編集してエクスポートできます。 **[データ]** タブで、 **[接続]** グループの **[プロパティ]** をクリックし、接続名の隣にある **[接続のプロパティ]** をクリックします。  
  
9. **[定義]** タブで、 **[接続ファイルのエクスポート]** をクリックします。  
  
10. ファイル名を入力し、 **[保存]** をクリックします。 アプリケーションと開いているすべてのファイルを閉じます。  
  
### <a name="to-upload-and-use-an-odc-file"></a>.odc ファイルをアップロードして使用するには  
  
1.  接続ファイルのアップロード先となるライブラリを開きます。  
  
2.  **[アップロード]** メニューの **[ドキュメントのアップロード]** をクリックします。  
  
3.  **[参照]** をクリックします。  
  
4.  作成した .odc ファイルを選択します。 既定では、.odc ファイルは [マイ ドキュメント] フォルダーの [My Data Sources] にあります。  
  
5.  **[開く]** をクリックしてファイルを選択し、 **[OK]** をクリックして選択したファイルを保存します。 新しいアイテムのプロパティ ページが自動的に開きます。  
  
6.  [コンテンツ タイプ] で **[レポート データ ソース]** を選択し、 **[OK]** をクリックします。  
  
7.  レポートをポイントします。  
  
8.  下矢印をクリックし、 **[データ ソースの管理]** を選択します。  
  
9. データ ソース名をクリックします。  
  
10. レポートでカスタム データ ソース情報を使用する場合は、 **[共有]** をクリックします。  
  
11. **[データ ソース リンク]** で、参照ボタン ( **[...]** ) をクリックします。  
  
12. アップロードする .odc ファイルを選択します。  
  
13. **[OK]** をクリックしてファイルを選択し、 **[OK]** をクリックして変更を保存します。  
  
     [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] サンプル データベースおよびサンプル レポートで上記の手順を行う場合、追加設定なしで .odc ファイルと連携して動作するのは Company Sales レポートのみであることに注意してください。 他のサンプル レポートには、OLE DB プロバイダーと互換性のないクエリ パラメーターや機能が含まれています。 ただし、レポート デザイナーでレポートを変更しておくことにより、レポートを OLE DB プロバイダーと連携させることもできます。  
  
## <a name="see-also"></a>参照  
 [共有データ ソースを作成、変更、および削除する &#40;SSRS&#41;](../../reporting-services/report-data/create-modify-and-delete-shared-data-sources-ssrs.md)  
  
