---
description: 結合の追加と編集
title: 結合の追加と編集 | Microsoft Docs
ms.custom: ''
ms.date: 03/14/2017
ms.prod: sql
ms.prod_service: database-engine
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
f1_keywords:
- sql13.rep.newpubwizard.addeditjoin.f1
- sql13.sql13.swb.agdashboard.arp4joinstate.issues.f1
ms.assetid: 3b546560-720f-48b8-9d63-cf159290e9d4
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 549970e81b86a8331c2d41afc3b01fab3eb7160b
ms.sourcegitcommit: bd3a135f061e4a49183bbebc7add41ab11872bae
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/21/2020
ms.locfileid: "92300737"
---
# <a name="add-or-edit-join"></a>結合の追加と編集
 [!INCLUDE [SQL Server](../../includes/applies-to-version/sqlserver.md)]
  **[結合の追加]** ダイアログ ボックスおよび **[結合の編集]** ダイアログ ボックスでは、マージ パブリケーションに使用する結合フィルターの追加と編集を行えます。  
  
> [!NOTE]  
>  既存のパブリケーション内のフィルターを編集するには、パブリケーション用の新しいスナップショットが必要です。 パブリケーションにサブスクリプションがある場合は、サブスクリプションを再度初期化する必要があります。 プロパティ変更の詳細については、「[パブリケーションおよびアーティクルのプロパティの変更](../../relational-databases/replication/publish/change-publication-and-article-properties.md)」を参照してください。  
  
 結合フィルターを使用すると、パブリケーションにおける関連するテーブルのフィルター方法に基づいて、テーブルにフィルターを適用できます。 一般的に、親テーブルにはパラメーター化された行フィルターが適用されます。次に、テーブル間の結合を定義するときとほぼ同じ方法で、1 つ以上の結合フィルターを定義します。 この結合フィルターにより、関連するテーブル内のデータが結合フィルター句と一致する場合にのみレプリケートされるように、行フィルターが拡張されます。  
  
 通常、結合フィルターは適用先のテーブルに定義されている主キー/外部キーのリレーションシップに従いますが、これに厳密に限定されてはいません。 結合フィルターは、2 つのアーティクル テーブル内の関連するデータを比較する、任意のロジックに基づくことができます。  
  
> [!IMPORTANT]  
>  結合フィルターに使用できるテーブルの数に制限はありませんが、多数のテーブルをフィルターに使用すると、マージ処理中のパフォーマンスに影響する場合があります。 テーブルが 5 つ以上の結合フィルターを生成する場合は、小さなテーブル、変更されないテーブル、プライマリ参照テーブルはフィルター選択しないという別の解決策を検討してください。 サブスクライバーの間で分割する必要があるテーブル間にのみ、結合フィルターを使用してください。  
  
## <a name="options"></a>Options  
 このダイアログ ボックスでは、3 つの手順で 2 つのテーブル間の結合フィルターを作成します。 結合フィルターを複数作成するには、このダイアログ ボックスの手順を複数回繰り返す必要があります。  
  
1.  **[フィルター選択されたテーブルを確認し、結合テーブルを選択します]**  
  
    -   新しい結合を追加する場合、 **[フィルター選択されたテーブル]** テキスト ボックス内のテーブルが適切かどうか確認します。適切でない場合には **[キャンセル]** をクリックし、 **[テーブル行のフィルター選択]** ページで正しいテーブルを選択して、 **[結合の追加]** をクリックし、このダイアログ ボックスに戻ります。 次に、 **[結合テーブル]** ドロップダウン リスト ボックスでテーブルを選択します。  
  
    -   既存の結合を編集する場合、テーブル名は既に指定されており、変更できません。 結合に使用されるテーブルを変更するには、 **[テーブル行のフィルター選択]** ページで既存の結合フィルターを削除して、別のテーブルの間に新しい結合を作成する必要があります。  
  
2.  **[JOIN ステートメントを作成します]**  
  
    -   新しい結合を追加する場合、 **[ビルダーを使用してステートメントを作成する]** または **[JOIN ステートメントを手動で作成する]** を選択します。 結合を手動で作成する場合、ビルダーは使用できません。  
  
         ビルダーの使用を選択した場合、グリッド内の列 ( **[結合]** 、 **[フィルター選択されたテーブルの列]** 、 **[演算子]** 、 **[結合テーブルの列]** ) を使用して JOIN ステートメントを作成します。 グリッド内の各列にはドロップダウン リスト ボックスがあり、これを使用して 2 つの列と 1 つの演算子 ( **=** 、 **<>** 、 **<=** 、 **\<**, **>=** 、 **>** 、 **[like]** ) を選択できます。 結果は **[プレビュー]** テキスト領域に表示されます。 結合に列が 2 組以上使用される場合には、 **[結合]** 列で結合 ( **[AND]** または **[OR]** ) を選択し、2 つの列と別の演算子を入力します。  
  
         ステートメントを手動で作成する場合、 **[JOIN ステートメント]** テキスト領域に JOIN ステートメントを入力します。 **[フィルター選択されたテーブルの列]** リスト ボックスと **[結合テーブルの列]** リスト ボックスを使用して、列を **[結合テーブルの列]** テキスト領域にドラッグ アンド ドロップします。  
  
    -   既存の結合を編集する場合、手動で編集する必要があります。  
  
3.  **[結合オプションを指定します]**  

    -   フィルター選択するテーブル内で結合する列が一意な場合、 **[一意キー : フィルター選択されたテーブルの 1 つの行に関連する結合テーブル内の行 (一対一または一対多の関係)]** を選択します。 列が一意の場合、特別なパフォーマンスの最適化機能をマージ処理で利用できます。  
  
        > [!CAUTION]  
        >  このオプションを選択すると、結合フィルターにおける子テーブルと親テーブルのリレーションシップが一対一または一対多となるように指定されます。 親テーブル内の結合する列に一意性を保証する制約がある場合にのみ、このオプションを選択してください。 このオプションを適切に設定しなかった場合、データを収束できない可能性があります。  
  
    -   [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 以降のバージョンのみです。 既定で、マージ レプリケーションでは同期中に行ごとに変化が処理されます。 関連する変更をまとめて処理するには、 **[論理レコード : フィルター選択されたテーブルと結合テーブルの関連する変更を同期時にトランザクションとして扱う]** を選択します。 このオプションは、論理レコードを使用するために必要なアーティクルとパブリケーションの要件が満たされている場合にのみ使用できます。 詳細については、「[論理レコードによる関連行への変更のグループ化](../../relational-databases/replication/merge/group-changes-to-related-rows-with-logical-records.md)」の「Considerations for Using Logical Records」 (論理レコードの使用についての注意点) を参照してください。  
  
 フィルターを追加または編集した後に、 **[OK]** をクリックして変更を保存し、ダイアログ ボックスを閉じます。 指定したフィルターは、SELECT 句のテーブルに対して解析され、実行されます。 フィルター ステートメントに構文エラーなどの問題がある場合には通知され、フィルター ステートメントを編集することができます。  
  
## <a name="see-also"></a>参照  
 [Create a Publication](../../relational-databases/replication/publish/create-a-publication.md)   
 [パブリケーション プロパティの表示および変更](../../relational-databases/replication/publish/view-and-modify-publication-properties.md)   
 [パブリッシュされたデータのフィルター処理](../../relational-databases/replication/publish/filter-published-data.md)   
 [Join Filters](../../relational-databases/replication/merge/join-filters.md)   
 [Parameterized Row Filters](../../relational-databases/replication/merge/parameterized-filters-parameterized-row-filters.md)   
 [データとデータベース オブジェクトのパブリッシュ](../../relational-databases/replication/publish/publish-data-and-database-objects.md)  
  
  
